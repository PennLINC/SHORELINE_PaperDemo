<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SHORELINEPaper">
<title>Head Motion Benchmark • SHORELINEPaper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Head Motion Benchmark">
<meta property="og:description" content="SHORELINEPaper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SHORELINEPaper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dmri_hmc_benchmark.html">Head Motion Benchmark</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="dmri_hmc_benchmark_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Head Motion Benchmark</h1>
            
            <h4 data-toc-skip class="date">2022-06-14</h4>
      
      
      <div class="d-none name"><code>dmri_hmc_benchmark.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this project, we used FiberFox to simulate entire dMRI series for ABCD, HCP, DSIQ5, and HASC55 data. Head motion was then introduced by applying rigid transforms to the streamline data (translations and rotations). Then, QSIPrep used both SHORELine and Eddy to estimate the introduced head motion — analysis of these results are evaluated in this notebook.</p>
</div>
<div class="section level2">
<h2 id="libraries-setup">Libraries &amp; Setup<a class="anchor" aria-label="anchor" href="#libraries-setup"></a>
</h2>
<p>The data are available on OSF at <a href="osf.io/7twne">this link</a>. This package internally downloads and cleans them for your convenience. They’re available preprocessed within the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># for viewing the preprocessed data</span>
<span class="va">motion_df</span> <span class="op">&lt;-</span> <span class="fu">SHORELINEPaper</span><span class="fu">::</span><span class="va">motion_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"error_df_wsetting"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"error_rmse_wsetting"</span><span class="op">)</span> <span class="co"># for analysis of estimated motion</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample">Sample<a class="anchor" aria-label="anchor" href="#sample"></a>
</h2>
<p>The table below shows the number of <code>b0</code>’s for each scheme:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motion_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span>
    <span class="va">iternum</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span>
      <span class="va">method</span> <span class="op">==</span> <span class="st">"SHORELine"</span> <span class="op">&amp;</span>
      <span class="va">denoising</span> <span class="op">==</span> <span class="st">"none"</span> <span class="op">&amp;</span>
      <span class="va">bval</span> <span class="op">&gt;</span> <span class="fl">100</span> <span class="op">&amp;</span>
      <span class="va">setting</span> <span class="op">==</span> <span class="st">"Affine"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">percent_motion</span>, <span class="va">scheme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>max_b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">bval</span><span class="op">)</span>,
            num_b <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">distinct</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">max_b</span>, <span class="va">num_b</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">row_to_names</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">add_row</span><span class="op">(</span>ABCD <span class="op">=</span> <span class="st">"Shelled"</span>, HCP <span class="op">=</span> <span class="st">"Shelled"</span>, DSIQ5 <span class="op">=</span> <span class="st">"Cartesian"</span>, HASC55 <span class="op">=</span> <span class="st">"Random"</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tab1</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'percent_motion'. You can override using</span>
<span class="co">## the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tab1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Type"</span>, <span class="st">"Max. b"</span>, <span class="st">"Num. b &gt; 0"</span><span class="op">)</span>

<span class="fu">gt</span><span class="op">(</span><span class="va">tab1</span>, rownames_to_stub <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span><span class="st">"Scheme properties and processing pipeline runs"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<div id="hnidkqkjme" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#hnidkqkjme .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hnidkqkjme .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnidkqkjme .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hnidkqkjme .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hnidkqkjme .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnidkqkjme .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hnidkqkjme .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hnidkqkjme .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hnidkqkjme .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hnidkqkjme .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hnidkqkjme .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hnidkqkjme .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#hnidkqkjme .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hnidkqkjme .gt_from_md > :first-child {
  margin-top: 0;
}

#hnidkqkjme .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hnidkqkjme .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hnidkqkjme .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hnidkqkjme .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hnidkqkjme .gt_row_group_first td {
  border-top-width: 2px;
}

#hnidkqkjme .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnidkqkjme .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hnidkqkjme .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hnidkqkjme .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnidkqkjme .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnidkqkjme .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hnidkqkjme .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hnidkqkjme .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hnidkqkjme .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnidkqkjme .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnidkqkjme .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hnidkqkjme .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hnidkqkjme .gt_left {
  text-align: left;
}

#hnidkqkjme .gt_center {
  text-align: center;
}

#hnidkqkjme .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hnidkqkjme .gt_font_normal {
  font-weight: normal;
}

#hnidkqkjme .gt_font_bold {
  font-weight: bold;
}

#hnidkqkjme .gt_font_italic {
  font-style: italic;
}

#hnidkqkjme .gt_super {
  font-size: 65%;
}

#hnidkqkjme .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#hnidkqkjme .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#hnidkqkjme .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hnidkqkjme .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#hnidkqkjme .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#hnidkqkjme .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Scheme properties and processing pipeline runs</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">ABCD</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">DSIQ5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">HASC55</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">HCP</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right gt_stub">Type</td>
<td class="gt_row gt_left">Shelled</td>
<td class="gt_row gt_left">Cartesian</td>
<td class="gt_row gt_left">Random</td>
<td class="gt_row gt_left">Shelled</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">Max. b</td>
<td class="gt_row gt_left">3000</td>
<td class="gt_row gt_left">4985</td>
<td class="gt_row gt_left">5015</td>
<td class="gt_row gt_left">3010</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">Num. b &gt; 0</td>
<td class="gt_row gt_left"> 96</td>
<td class="gt_row gt_left">257</td>
<td class="gt_row gt_left"> 55</td>
<td class="gt_row gt_left">270</td>
</tr>
</tbody>
</table>
</div>
<p>Below is a breakdown of how the runs were accumulated:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motion_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">volnum</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span>Algorithm <span class="op">=</span> <span class="va">method</span>, Model <span class="op">=</span> <span class="va">setting</span>, Denoising <span class="op">=</span> <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="va">scheme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by_all</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">scheme</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>Denoising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Denoising</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="st">"None"</span>, <span class="st">"MP-PCA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, <span class="st">" %"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># insert empty string for tidyness</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Algorithm</span>, <span class="va">Model</span>, <span class="va">Denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Algorithm</span><span class="op">:</span><span class="va">Denoising</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Algorithm</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_spanner</span><span class="op">(</span><span class="st">"# Pipeline Runs"</span>, columns <span class="op">=</span> <span class="va">ABCD</span><span class="op">:</span><span class="va">HASC55</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_align</span><span class="op">(</span>align <span class="op">=</span> <span class="st">"right"</span>, columns <span class="op">=</span> <span class="va">percent_motion</span><span class="op">:</span><span class="va">HASC55</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_row_group</span><span class="op">(</span>
    label <span class="op">=</span> <span class="st">"Eddy"</span>,
    rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_row_group</span><span class="op">(</span>
    label <span class="op">=</span> <span class="st">"SHORELine"</span>,
    rows <span class="op">=</span> <span class="fl">13</span><span class="op">:</span><span class="fl">24</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'Algorithm', 'Model', 'Denoising',</span>
<span class="co">## 'percent_motion'. You can override using the `.groups` argument.</span></code></pre>
<div id="tdfztlykqk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tdfztlykqk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdfztlykqk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdfztlykqk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdfztlykqk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdfztlykqk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdfztlykqk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdfztlykqk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdfztlykqk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdfztlykqk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdfztlykqk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdfztlykqk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdfztlykqk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#tdfztlykqk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdfztlykqk .gt_from_md > :first-child {
  margin-top: 0;
}

#tdfztlykqk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdfztlykqk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdfztlykqk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tdfztlykqk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tdfztlykqk .gt_row_group_first td {
  border-top-width: 2px;
}

#tdfztlykqk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdfztlykqk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tdfztlykqk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tdfztlykqk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdfztlykqk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdfztlykqk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdfztlykqk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdfztlykqk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdfztlykqk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdfztlykqk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdfztlykqk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdfztlykqk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdfztlykqk .gt_left {
  text-align: left;
}

#tdfztlykqk .gt_center {
  text-align: center;
}

#tdfztlykqk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdfztlykqk .gt_font_normal {
  font-weight: normal;
}

#tdfztlykqk .gt_font_bold {
  font-weight: bold;
}

#tdfztlykqk .gt_font_italic {
  font-style: italic;
}

#tdfztlykqk .gt_super {
  font-size: 65%;
}

#tdfztlykqk .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#tdfztlykqk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#tdfztlykqk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tdfztlykqk .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#tdfztlykqk .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#tdfztlykqk .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1">Model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1">Denoising</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1">percent_motion</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4">
        <span class="gt_column_spanner"># Pipeline Runs</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ABCD</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HCP</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">DSIQ5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HASC55</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="7" class="gt_group_heading">SHORELine</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">Affine</td>
<td class="gt_row gt_left">MP-PCA</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left">Affine</td>
<td class="gt_row gt_left">None</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left">Rigid</td>
<td class="gt_row gt_left">MP-PCA</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left">Rigid</td>
<td class="gt_row gt_left">None</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="7" class="gt_group_heading">Eddy</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_left">Linear</td>
<td class="gt_row gt_left">MP-PCA</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left">Linear</td>
<td class="gt_row gt_left">None</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left">Quadratic</td>
<td class="gt_row gt_left">MP-PCA</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left">Quadratic</td>
<td class="gt_row gt_left">None</td>
<td class="gt_row gt_right">15 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">30 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_right">50 %</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">30</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
</tbody>
</table>
</div>
<p>And finally the total scans and volumes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motion_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">volnum</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span>Algorithm <span class="op">=</span> <span class="va">method</span>, Model <span class="op">=</span> <span class="va">setting</span>, Denoising <span class="op">=</span> <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="va">scheme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by_all</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">scheme</span>, values_from <span class="op">=</span> <span class="va">n</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>Denoising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Denoising</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="st">"None"</span>, <span class="st">"MP-PCA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, <span class="st">" %"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Algorithm</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">ABCD</span><span class="op">:</span><span class="va">HASC55</span>,<span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span><span class="st">"Total Scans"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'Algorithm', 'Model', 'Denoising',</span>
<span class="co">## 'percent_motion'. You can override using the `.groups` argument.</span></code></pre>
<div id="ivzxwfknlc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ivzxwfknlc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ivzxwfknlc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivzxwfknlc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ivzxwfknlc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ivzxwfknlc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivzxwfknlc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ivzxwfknlc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ivzxwfknlc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ivzxwfknlc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ivzxwfknlc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ivzxwfknlc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ivzxwfknlc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ivzxwfknlc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ivzxwfknlc .gt_from_md > :first-child {
  margin-top: 0;
}

#ivzxwfknlc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ivzxwfknlc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ivzxwfknlc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ivzxwfknlc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ivzxwfknlc .gt_row_group_first td {
  border-top-width: 2px;
}

#ivzxwfknlc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivzxwfknlc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ivzxwfknlc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ivzxwfknlc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivzxwfknlc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivzxwfknlc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ivzxwfknlc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ivzxwfknlc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ivzxwfknlc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivzxwfknlc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivzxwfknlc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ivzxwfknlc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ivzxwfknlc .gt_left {
  text-align: left;
}

#ivzxwfknlc .gt_center {
  text-align: center;
}

#ivzxwfknlc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ivzxwfknlc .gt_font_normal {
  font-weight: normal;
}

#ivzxwfknlc .gt_font_bold {
  font-weight: bold;
}

#ivzxwfknlc .gt_font_italic {
  font-style: italic;
}

#ivzxwfknlc .gt_super {
  font-size: 65%;
}

#ivzxwfknlc .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ivzxwfknlc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ivzxwfknlc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ivzxwfknlc .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ivzxwfknlc .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ivzxwfknlc .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Total Scans</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Algorithm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">ABCD</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HCP</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">DSIQ5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">HASC55</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">Eddy</td>
<td class="gt_row gt_right">360</td>
<td class="gt_row gt_right">360</td>
<td class="gt_row gt_right">0</td>
<td class="gt_row gt_right">0</td>
</tr>
<tr>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_right">360</td>
<td class="gt_row gt_right">360</td>
<td class="gt_row gt_right">360</td>
<td class="gt_row gt_right">360</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">motion_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">bval</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span>Algorithm <span class="op">=</span> <span class="va">method</span>, Model <span class="op">=</span> <span class="va">setting</span>, Denoising <span class="op">=</span> <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="va">scheme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>`Total b &gt; 0 Volumes` <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">row_to_names</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gt</span><span class="op">(</span>rownames_to_stub <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<div id="eangbfgbqy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#eangbfgbqy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eangbfgbqy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eangbfgbqy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eangbfgbqy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eangbfgbqy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eangbfgbqy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eangbfgbqy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eangbfgbqy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eangbfgbqy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eangbfgbqy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eangbfgbqy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eangbfgbqy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#eangbfgbqy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eangbfgbqy .gt_from_md > :first-child {
  margin-top: 0;
}

#eangbfgbqy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eangbfgbqy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eangbfgbqy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eangbfgbqy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eangbfgbqy .gt_row_group_first td {
  border-top-width: 2px;
}

#eangbfgbqy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eangbfgbqy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eangbfgbqy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eangbfgbqy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eangbfgbqy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eangbfgbqy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eangbfgbqy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eangbfgbqy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eangbfgbqy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eangbfgbqy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eangbfgbqy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eangbfgbqy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eangbfgbqy .gt_left {
  text-align: left;
}

#eangbfgbqy .gt_center {
  text-align: center;
}

#eangbfgbqy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eangbfgbqy .gt_font_normal {
  font-weight: normal;
}

#eangbfgbqy .gt_font_bold {
  font-weight: bold;
}

#eangbfgbqy .gt_font_italic {
  font-style: italic;
}

#eangbfgbqy .gt_super {
  font-size: 65%;
}

#eangbfgbqy .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#eangbfgbqy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#eangbfgbqy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eangbfgbqy .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#eangbfgbqy .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#eangbfgbqy .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">ABCD</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">DSIQ5</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">HASC55</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">HCP</th>
    </tr></thead>
<tbody class="gt_table_body"><tr>
<td class="gt_row gt_right gt_stub">Total b &gt; 0 Volumes</td>
<td class="gt_row gt_left"> 69120</td>
<td class="gt_row gt_left"> 92520</td>
<td class="gt_row gt_left"> 19800</td>
<td class="gt_row gt_left">194400</td>
</tr></tbody>
</table>
</div>
<p>Note that errors for rotation are converted from radians to degrees, and we also extract only the <span class="math inline">\(b &gt; 0\)</span> volumes. Both Eddy and SHORELine use different methods (non-GP and non-SHORE) for motion-correcting these images.</p>
</div>
<div class="section level2">
<h2 id="motion-analysis">Motion Analysis<a class="anchor" aria-label="anchor" href="#motion-analysis"></a>
</h2>
<div class="section level3">
<h3 id="is-there-an-rmse-difference-between-the-rigidaffine-and-linearquadratic-settings">1. Is there an RMSE difference between the Rigid/Affine and Linear/Quadratic settings?<a class="anchor" aria-label="anchor" href="#is-there-an-rmse-difference-between-the-rigidaffine-and-linearquadratic-settings"></a>
</h3>
<p>We tested Rigid and Affine transformation models for SHORELine and Linear and Quadratic models in Eddy. In Eddy, the models only affect Eddy current correction so we shouldn’t see a difference in head motion estimates. SHORELine may or may not benefit from having more degrees of freedom in the transformation model.</p>
<p>Here we test whether there are significant effects of transformation model. Under the hood R will pair the same scans and perform a paired t-test by subtracting alphabetically. For SHORELine this means Affine - Rigid and for Eddy it means Linear - Quadratic.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO put these long functions into a function</span>

<span class="co"># TODO Helvetica in the header and stub</span>

<span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">error_rmse_wsetting</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rename</span><span class="op">(</span>hmc_method<span class="op">=</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">hmc_method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">do</span><span class="op">(</span>test <span class="op">=</span> <span class="fu">tidy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">rmse</span> <span class="op">~</span> <span class="va">setting</span>, data<span class="op">=</span><span class="va">.</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">test</span><span class="op">)</span>

<span class="co"># Adjust the p-values and order them by the largest absolute effects</span>
<span class="va">setting_tests_adj</span> <span class="op">&lt;-</span> <span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="va">method</span>, <span class="va">alternative</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="fu">pivot_wider</span><span class="op">(</span>
    names_from <span class="op">=</span> <span class="va">motion.type</span>, 
    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">:</span><span class="va">conf.high</span><span class="op">)</span>
    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># p adjust any pvalues</span>
  <span class="fu">mutate</span><span class="op">(</span>
    <span class="fu">across</span><span class="op">(</span>
      <span class="fu">contains</span><span class="op">(</span><span class="st">"p.value"</span><span class="op">)</span>,
       <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,
      .names <span class="op">=</span> <span class="st">"Adjusted_{.col}"</span>
      <span class="op">)</span>
    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>

  <span class="co"># filter sig pvals</span>
  <span class="co"># no eddy rows should get through this filter</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">if_any</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"Adjusted"</span><span class="op">)</span>, <span class="op">~</span><span class="va">.x</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span>

<span class="va">setting_tests_adj</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span>Method <span class="op">=</span> <span class="va">hmc_method</span>, Scheme <span class="op">=</span> <span class="va">scheme</span>, Denoising <span class="op">=</span> <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>      
  <span class="co"># reorder columns</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">Method</span>, <span class="va">Scheme</span>, <span class="va">Denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># convert to char for empty strings &amp;</span>
  <span class="co"># insert empty strings for every group where the values are duplicated</span>
  <span class="co"># for clarity</span>
  
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Method</span>, <span class="va">Scheme</span>, <span class="va">Denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Method</span><span class="op">:</span><span class="va">Denoising</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># precision for the confidence intervals that get merged</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="fu">matches</span><span class="op">(</span><span class="st">"^p.value"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># last details</span>
  <span class="fu">mutate</span><span class="op">(</span>Denoising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Denoising</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="st">"None"</span>, <span class="st">"DWIDenoise"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  
  <span class="fu">gt</span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">"Scheme"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">setting_tests_gt</span>
  
<span class="va">setting_tests_gt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_spanner</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"*Rotation*"</span><span class="op">)</span>, columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_spanner</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"*Translation*"</span><span class="op">)</span>, columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"Translation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># string format confidence intervals</span>
  <span class="fu">cols_merge</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">conf.low_Translation</span>, <span class="va">conf.high_Translation</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"[{1}, {2}]"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    conf.low_Translation <span class="op">=</span> <span class="st">"95% CI"</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_merge</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">conf.low_Rotation</span>, <span class="va">conf.high_Rotation</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"[{1}, {2}]"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    conf.low_Rotation <span class="op">=</span> <span class="st">"95% CI"</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt</span><span class="op">(</span>
    columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"p.value"</span><span class="op">)</span>,
    fns <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html" class="external-link">format.pval</a></span><span class="op">(</span><span class="va">x</span>, eps<span class="op">=</span><span class="fl">0.0001</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>
    columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"statistic|estimate"</span><span class="op">)</span>,
    decimals <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    Adjusted_p.value_Rotation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Adj. *p*-value"</span><span class="op">)</span>,
    Adjusted_p.value_Translation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Adj. *p*-value"</span><span class="op">)</span>,
    estimate_Rotation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Estimate"</span><span class="op">)</span>,
    estimate_Translation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Estimate"</span><span class="op">)</span>,
    statistic_Rotation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Statistic"</span><span class="op">)</span>,
    statistic_Translation <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Statistic"</span><span class="op">)</span>,
    percent_motion <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"% Motion"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="fu">data_color</span><span class="op">(</span>
    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">estimate_Translation</span>, <span class="va">estimate_Rotation</span><span class="op">)</span>,
    colors <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/col_numeric.html" class="external-link">col_numeric</a></span><span class="op">(</span>
      palette <span class="op">=</span> <span class="fu">rocket</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,
      domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_style</span><span class="op">(</span>
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu">cell_text</span><span class="op">(</span>font <span class="op">=</span> <span class="st">"Helvetica"</span><span class="op">)</span>
      <span class="op">)</span>,
    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>
      columns <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>,
      rows <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_style</span><span class="op">(</span>
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
      <span class="op">)</span>,
    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_style</span><span class="op">(</span>
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
      <span class="op">)</span>,
    locations <span class="op">=</span> <span class="fu">cells_column_spanners</span><span class="op">(</span>spanners <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span><span class="fu">md</span><span class="op">(</span><span class="st">"**Predicting RMSE of Motion Estimates**"</span><span class="op">)</span>,
             subtitle <span class="op">=</span> <span class="st">"Evaluation of Effects on Transformation"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<div id="vyvdnodhwy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vyvdnodhwy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vyvdnodhwy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vyvdnodhwy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vyvdnodhwy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vyvdnodhwy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyvdnodhwy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vyvdnodhwy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vyvdnodhwy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vyvdnodhwy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vyvdnodhwy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vyvdnodhwy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vyvdnodhwy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vyvdnodhwy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vyvdnodhwy .gt_from_md > :first-child {
  margin-top: 0;
}

#vyvdnodhwy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vyvdnodhwy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vyvdnodhwy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vyvdnodhwy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vyvdnodhwy .gt_row_group_first td {
  border-top-width: 2px;
}

#vyvdnodhwy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyvdnodhwy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vyvdnodhwy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vyvdnodhwy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyvdnodhwy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyvdnodhwy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vyvdnodhwy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vyvdnodhwy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vyvdnodhwy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vyvdnodhwy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyvdnodhwy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vyvdnodhwy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vyvdnodhwy .gt_left {
  text-align: left;
}

#vyvdnodhwy .gt_center {
  text-align: center;
}

#vyvdnodhwy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vyvdnodhwy .gt_font_normal {
  font-weight: normal;
}

#vyvdnodhwy .gt_font_bold {
  font-weight: bold;
}

#vyvdnodhwy .gt_font_italic {
  font-style: italic;
}

#vyvdnodhwy .gt_super {
  font-size: 65%;
}

#vyvdnodhwy .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#vyvdnodhwy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vyvdnodhwy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vyvdnodhwy .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#vyvdnodhwy .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#vyvdnodhwy .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="12" class="gt_heading gt_title gt_font_normal" style><strong>Predicting RMSE of Motion Estimates</strong></th>
    </tr>
<tr>
<th colspan="12" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Evaluation of Effects on Transformation</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="font-weight: bold;">Method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="font-weight: bold;">Denoising</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" style="font-weight: bold;">% Motion</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4" style="font-weight: bold;">
        <span class="gt_column_spanner"><em>Rotation</em></span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="4" style="font-weight: bold;">
        <span class="gt_column_spanner"><em>Translation</em></span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Adj. <em>p</em>-value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Adj. <em>p</em>-value</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #E13945; color: #FFFFFF; font-family: Helvetica;">0.247</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">13.695</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.21, 0.28]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #2B1636; color: #FFFFFF; font-family: Helvetica;">−0.032</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−9.312</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.03]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #9E1B59; color: #FFFFFF; font-family: Helvetica;">0.135</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">10.929</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.11, 0.16]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #241431; color: #FFFFFF; font-family: Helvetica;">−0.044</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−11.353</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.05, -0.04]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #801E59; color: #FFFFFF; font-family: Helvetica;">0.095</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">11.360</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.08, 0.11]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #641F52; color: #FFFFFF; font-family: Helvetica;">0.054</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.479</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.18, 0.29]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">None</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #E23D45; color: #FFFFFF; font-family: Helvetica;">0.252</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">13.859</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.21, 0.29]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #291635; color: #FFFFFF; font-family: Helvetica;">−0.036</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−11.397</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.03]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #A41A59; color: #FFFFFF; font-family: Helvetica;">0.144</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">11.774</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.12, 0.17]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #231430; color: #FFFFFF; font-family: Helvetica;">−0.047</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−11.954</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.05, -0.04]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #7C1E58; color: #FFFFFF; font-family: Helvetica;">0.088</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">10.640</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.07, 0.11]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #1C122A; color: #FFFFFF; font-family: Helvetica;">−0.060</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−13.451</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.07, -0.05]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #F6B591; color: #000000; font-family: Helvetica;">0.417</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">40.240</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.40, 0.44]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #271534; color: #FFFFFF; font-family: Helvetica;">−0.038</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−18.948</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.03]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #E54344; color: #FFFFFF; font-family: Helvetica;">0.259</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">19.352</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.23, 0.29]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #2A1636; color: #FFFFFF; font-family: Helvetica;">−0.033</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−13.796</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.03]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #951C59; color: #FFFFFF; font-family: Helvetica;">0.124</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">9.790</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.10, 0.15]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #2E1739; color: #FFFFFF; font-family: Helvetica;">−0.026</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−12.963</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.03, -0.02]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">None</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #F6BA97; color: #000000; font-family: Helvetica;">0.425</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">39.922</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.40, 0.45]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #261533; color: #FFFFFF; font-family: Helvetica;">−0.040</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−19.837</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.04]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #E64744; color: #FFFFFF; font-family: Helvetica;">0.265</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">18.940</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.24, 0.29]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #2A1636; color: #FFFFFF; font-family: Helvetica;">−0.033</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−14.515</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.04, -0.03]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #961C59; color: #FFFFFF; font-family: Helvetica;">0.125</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">9.735</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.10, 0.15]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #2E1739; color: #FFFFFF; font-family: Helvetica;">−0.026</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−13.125</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.03, -0.02]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">DSIQ5</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #7A1E58; color: #FFFFFF; font-family: Helvetica;">0.086</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">11.138</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.07, 0.10]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3E1A41; color: #FFFFFF; font-family: Helvetica;">−0.003</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−1.445</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #651F53; color: #FFFFFF; font-family: Helvetica;">0.055</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">8.305</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.04, 0.07]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #701F55; color: #FFFFFF; font-family: Helvetica;">0.071</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.931</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.09, 0.23]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #5B1E50; color: #FFFFFF; font-family: Helvetica;">0.042</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">6.898</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.03, 0.05]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3E1A42; color: #FFFFFF; font-family: Helvetica;">−0.001</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−0.361</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.01]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">DSIQ5</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">None</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #7E1E59; color: #FFFFFF; font-family: Helvetica;">0.092</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">11.753</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.08, 0.11]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3D1A41; color: #FFFFFF; font-family: Helvetica;">−0.003</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−1.786</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #651F53; color: #FFFFFF; font-family: Helvetica;">0.056</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">8.261</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.04, 0.07]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3C1A41; color: #FFFFFF; font-family: Helvetica;">−0.005</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−1.692</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #5C1E51; color: #FFFFFF; font-family: Helvetica;">0.043</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">6.183</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.03, 0.06]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #401A43; color: #FFFFFF; font-family: Helvetica;">0.001</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.253</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.01]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HASC55</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #AA1958; color: #FFFFFF; font-family: Helvetica;">0.153</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">11.189</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.12, 0.18]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3D1A41; color: #FFFFFF; font-family: Helvetica;">−0.004</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−1.028</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #8F1D5A; color: #FFFFFF; font-family: Helvetica;">0.115</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">7.723</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.08, 0.15]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #39193E; color: #FFFFFF; font-family: Helvetica;">−0.010</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−3.373</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.02, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.0489</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #7B1E58; color: #FFFFFF; font-family: Helvetica;">0.087</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">6.415</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.06, 0.11]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #31183A; color: #FFFFFF; font-family: Helvetica;">−0.022</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−3.811</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.03, -0.01]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.0167</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HASC55</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">SHORELine</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">None</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">15</td>
<td class="gt_row gt_right" style="background-color: #D1264B; color: #FFFFFF; font-family: Helvetica;">0.214</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">10.330</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.17, 0.26]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #451B45; color: #FFFFFF; font-family: Helvetica;">0.008</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.183</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">30</td>
<td class="gt_row gt_right" style="background-color: #951C59; color: #FFFFFF; font-family: Helvetica;">0.123</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">7.457</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.09, 0.16]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #3D1A41; color: #FFFFFF; font-family: Helvetica;">−0.004</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−0.907</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.01, 0.00]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">1.0000</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;"></td>
<td class="gt_row gt_left" style="font-family: Helvetica;">DWIDenoise</td>
<td class="gt_row gt_left" style="font-family: Helvetica;">50</td>
<td class="gt_row gt_right" style="background-color: #7A1E58; color: #FFFFFF; font-family: Helvetica;">0.086</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">6.134</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[0.06, 0.12]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">&lt;1e-04</td>
<td class="gt_row gt_right" style="background-color: #35183C; color: #FFFFFF; font-family: Helvetica;">−0.017</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">−3.517</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">[-0.03, -0.01]</td>
<td class="gt_row gt_right" style="font-family: Helvetica;">0.0350</td>
</tr>
</tbody>
</table>
</div>
<p>We can see that all the effects that survive a filter for <span class="math inline">\(\text{Adjusted-}p &lt; 0.01\)</span> are for SHORELine and the estimates are positive. This means that Affine RMSE is greater than Rigid RMSE. Although these estimates are all tiny, we will simplify subsequent comparisons by only choosing rigid. Rigid also has the benefit of much shorter run times than Affine. As expected, there are no differences for Eddy.</p>
<p>We’ll subset the RMSE values to just those we’re using for the rest of the comparisons:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Only look at one setting per method</span>
<span class="va">error_rmse</span> <span class="op">&lt;-</span> <span class="va">error_rmse_wsetting</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">setting</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rigid"</span>, <span class="st">"Quadratic"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">setting</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarization-of-motion-detection-errors">2. Summarization of Motion Detection Errors<a class="anchor" aria-label="anchor" href="#summarization-of-motion-detection-errors"></a>
</h3>
<p>Here we summarize how big errors were in estimating head motion. We first look at the distribution of errors to check that it’s centered around zero, and that this is the case for both eddy and shoreline.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO generally improve this plot</span>

<span class="va">error_df_wsetting</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">method</span>, <span class="va">scheme</span>, <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="va">motion.type</span>, Error <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Error</span> <span class="op">&lt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">Error</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">20</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># very egregious errors</span>
  <span class="fu">mutate</span><span class="op">(</span>percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">ordered</a></span><span class="op">(</span><span class="va">percent_motion</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">30</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">Error</span>, y<span class="op">=</span><span class="va">percent_motion</span>, fill<span class="op">=</span><span class="va">scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_slab</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, width <span class="op">=</span> <span class="fl">0</span>, .width <span class="op">=</span> <span class="fl">0</span>, point_colour <span class="op">=</span> <span class="cn">NA</span>, expand<span class="op">=</span><span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">method</span> <span class="op">~</span> <span class="va">motion.type</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Distribution of Motion Estimate Errors"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-6-1.png" width="1152"></p>
<p>Next we see what the standard deviation of the error is. This tells us, on average, the amount of degrees or mm we can expect an error to be for each method.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO put formatting into a function</span>

<span class="va">rmse_summaries</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            sd_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            se_rmse<span class="op">=</span><span class="va">sd_rmse</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span><span class="op">)</span>,
            group_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'motion.type',</span>
<span class="co">## 'method'. You can override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries</span> <span class="op">&lt;-</span> <span class="va">rmse_summaries</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>
    motion.type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Rotation"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Rotation (degrees)"</span>,
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Translation"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Translation (mm)"</span>
      <span class="op">)</span>,
    Denoising<span class="op">=</span><span class="fu">case_when</span><span class="op">(</span><span class="va">denoising</span> <span class="op">==</span> <span class="st">"none"</span>  <span class="op">~</span> <span class="st">"None"</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"MP-PCA"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span>
    
  <span class="op">)</span>

<span class="va">pd</span><span class="op">=</span><span class="fu">position_dodge2</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.7</span>, preserve<span class="op">=</span><span class="st">"single"</span><span class="op">)</span>
<span class="va">linetypes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"None"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"MP-PCA"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="va">error_mean_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>
      y<span class="op">=</span><span class="va">group_mean_error</span>, x<span class="op">=</span><span class="va">percent_motion</span>, 
      fill<span class="op">=</span><span class="va">method</span>, group<span class="op">=</span><span class="va">Denoising</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>alpha<span class="op">=</span><span class="va">Denoising</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="va">pd</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">group_mean_error</span><span class="op">+</span><span class="va">mean_rmse</span>,
        ymin<span class="op">=</span><span class="va">group_mean_error</span><span class="op">-</span><span class="va">mean_rmse</span>,
        width<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>, position<span class="op">=</span><span class="va">pd</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span>, guide<span class="op">=</span><span class="st">"none"</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_alpha_manual</span><span class="op">(</span>
    name<span class="op">=</span><span class="st">"Denoising Strategy"</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Head Motion Estimate Error"</span>, 
       y <span class="op">=</span> <span class="st">"Mean Error (±Mean RMSE)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span>
       <span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>linetype<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO reduce plot size, increase font size</span>
<span class="va">error_mean_plt</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/error_mean_plot-1.png" width="1152"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize the motion rmse in the different cells</span>
<span class="co"># rmse_plt &lt;-  ggplot(</span>
<span class="co">#     rmse_summaries,</span>
<span class="co">#     aes(</span>
<span class="co">#       y=mean_rmse, x=percent_motion, </span>
<span class="co">#       color=method, fill=method)</span>
<span class="co">#     ) +</span>
<span class="co">#   geom_bar(aes(alpha=Denoising), stat="identity", position=pd, width = 0.6) +</span>
<span class="co">#   geom_errorbar(</span>
<span class="co">#     aes(ymax=mean_rmse+sd_rmse, ymin=mean_rmse-sd_rmse,</span>
<span class="co">#         width=0.6),</span>
<span class="co">#     color = "black", position=pd</span>
<span class="co">#     ) +</span>
<span class="co">#   facet_grid(motion.type~scheme, scales="free") + </span>
<span class="co">#   scale_color_manual(</span>
<span class="co">#     values=c("SHORELine"="#d95f02", "Eddy"="#1b9e77"), guide="none"</span>
<span class="co">#     ) +</span>
<span class="co">#   scale_fill_manual(</span>
<span class="co">#     values=c("SHORELine"="#d95f02", "Eddy"="#1b9e77")</span>
<span class="co">#     ) +</span>
<span class="co">#   scale_alpha_manual(</span>
<span class="co">#     name="Denoising Strategy",</span>
<span class="co">#     values=c(1.0, 0.5)</span>
<span class="co">#     ) +</span>
<span class="co">#   theme_bw(</span>
<span class="co">#     base_family="Helvetica",</span>
<span class="co">#     base_size=12</span>
<span class="co">#   ) +</span>
<span class="co">#   labs(title = "Motion Estimate RMSE",</span>
<span class="co">#        y = "Mean RMSE (±SD)", </span>
<span class="co">#        x = "Percent Motion Volumes", </span>
<span class="co">#        fill = "Method",</span>
<span class="co">#        ) +</span>
<span class="co">#   guides(linetype=guide_legend(override.aes=list(fill=NA)))</span>


<span class="va">rmse_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>
      y<span class="op">=</span><span class="va">mean_rmse</span>, x<span class="op">=</span><span class="va">percent_motion</span>, 
      fill<span class="op">=</span><span class="va">method</span>, group<span class="op">=</span><span class="va">Denoising</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>alpha<span class="op">=</span><span class="va">Denoising</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="va">pd</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">mean_rmse</span><span class="op">+</span><span class="va">sd_rmse</span>, ymin<span class="op">=</span><span class="va">mean_rmse</span><span class="op">-</span><span class="va">sd_rmse</span>,
        width<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>, position<span class="op">=</span><span class="va">pd</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_alpha_manual</span><span class="op">(</span>
    name<span class="op">=</span><span class="st">"Denoising Strategy"</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Motion Estimate RMSE"</span>,
       y <span class="op">=</span> <span class="st">"Mean RMSE (±SD)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span>,
       <span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>linetype<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_plt</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/rmse_plot-1.png" width="1152"></p>
<p>Here is how means were reported in the paper, and also how they were calculated for the OHBM poster.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO formatting</span>
<span class="va">errs</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span>

<span class="va">errs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span><span class="st">"Mean RMSE by Motion Type"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<div id="ohuwysnhhs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ohuwysnhhs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ohuwysnhhs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ohuwysnhhs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ohuwysnhhs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ohuwysnhhs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ohuwysnhhs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ohuwysnhhs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ohuwysnhhs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ohuwysnhhs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ohuwysnhhs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ohuwysnhhs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ohuwysnhhs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ohuwysnhhs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ohuwysnhhs .gt_from_md > :first-child {
  margin-top: 0;
}

#ohuwysnhhs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ohuwysnhhs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ohuwysnhhs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ohuwysnhhs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ohuwysnhhs .gt_row_group_first td {
  border-top-width: 2px;
}

#ohuwysnhhs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ohuwysnhhs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ohuwysnhhs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ohuwysnhhs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ohuwysnhhs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ohuwysnhhs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ohuwysnhhs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ohuwysnhhs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ohuwysnhhs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ohuwysnhhs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ohuwysnhhs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ohuwysnhhs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ohuwysnhhs .gt_left {
  text-align: left;
}

#ohuwysnhhs .gt_center {
  text-align: center;
}

#ohuwysnhhs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ohuwysnhhs .gt_font_normal {
  font-weight: normal;
}

#ohuwysnhhs .gt_font_bold {
  font-weight: bold;
}

#ohuwysnhhs .gt_font_italic {
  font-style: italic;
}

#ohuwysnhhs .gt_super {
  font-size: 65%;
}

#ohuwysnhhs .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ohuwysnhhs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ohuwysnhhs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ohuwysnhhs .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ohuwysnhhs .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ohuwysnhhs .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Mean RMSE by Motion Type</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">motion.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_mean_error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sd_mean_error</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">Rotation</td>
<td class="gt_row gt_right">0.19375489</td>
<td class="gt_row gt_right">0.3876132</td>
</tr>
<tr>
<td class="gt_row gt_left">Translation</td>
<td class="gt_row gt_right">0.01237718</td>
<td class="gt_row gt_right">0.1987452</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="compare-performance-on-sampling-schemes">3. Compare Performance on Sampling Schemes<a class="anchor" aria-label="anchor" href="#compare-performance-on-sampling-schemes"></a>
</h3>
<p>There are 4 sampling schemes compared here. How well do the motion correction methods work on each?</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries_collapsed</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">method</span>, <span class="va">denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            sd_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            se_rmse<span class="op">=</span><span class="va">sd_rmse</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span><span class="op">)</span>,
            group_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>denoised <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">denoising</span>, none<span class="op">=</span><span class="st">""</span>, dwidenoise<span class="op">=</span><span class="st">"+ MP-PCA"</span><span class="op">)</span>,
         method_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">denoised</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">denoised</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">method_name</span> <span class="op">!=</span> <span class="st">"SHORELine + MP-PCA"</span><span class="op">)</span> <span class="co"># no difference, so skip it</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'scheme', 'motion.type', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries_collapsed</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>
    num_directions <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">scheme</span> <span class="op">==</span> <span class="st">"ABCD"</span>    <span class="op">~</span> <span class="fl">103</span>,
      <span class="va">scheme</span> <span class="op">==</span> <span class="st">"HCP"</span>     <span class="op">~</span> <span class="fl">270</span>,
      <span class="va">scheme</span> <span class="op">==</span> <span class="st">"DSIQ5"</span>   <span class="op">~</span> <span class="fl">257</span>,
      <span class="va">scheme</span> <span class="op">==</span> <span class="st">"HASC55"</span>  <span class="op">~</span> <span class="fl">55</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
<span class="co"># rmse_summaries_collapsed$num_directions &lt;- recode(</span>
<span class="co">#   rmse_summaries_collapsed$scheme,</span>
<span class="co">#   ABCD=103,</span>
<span class="co">#   HCP=270,</span>
<span class="co">#   DSIQ5=257,</span>
<span class="co">#   HASC55=55)</span>

  <span class="fu">mutate</span><span class="op">(</span>
    denoiser <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">denoising</span> <span class="op">==</span> <span class="st">"none"</span> <span class="op">~</span> <span class="st">"None"</span>,
      <span class="cn">TRUE</span>                <span class="op">~</span> <span class="st">"MP-PCA"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
<span class="co"># rmse_summaries_collapsed$denoiser &lt;- recode(</span>
<span class="co">#   rmse_summaries_collapsed$denoising,</span>
<span class="co">#   none="None",</span>
<span class="co">#   dwidenoise="MP-PCA"</span>
<span class="co"># )</span>

  <span class="fu">mutate</span><span class="op">(</span>
    scheme_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">scheme</span>, <span class="st">"ABCD|HCP"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Shelled"</span>,
      <span class="cn">TRUE</span>                            <span class="op">~</span> <span class="st">"Non-Shelled"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
<span class="co"># rmse_summaries_collapsed$scheme_type = recode(</span>
<span class="co">#   rmse_summaries_collapsed$scheme,</span>
<span class="co">#   ABCD="Shelled",</span>
<span class="co">#   HCP="Shelled",</span>
<span class="co">#   DSIQ5="Non-Shelled",</span>
<span class="co">#   HASC55="Non-Shelled")</span>

  <span class="fu">mutate</span><span class="op">(</span>
    motion.type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Rotation"</span><span class="op">)</span>     <span class="op">~</span> <span class="st">"Rotation (degrees)"</span>,
      <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Translation"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Tranlation (mm)"</span>,
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">rmse_summaries_collapsed</span>
<span class="co"># rmse_summaries_collapsed$motion.type &lt;- recode(</span>
<span class="co">#   rmse_summaries_collapsed$motion.type,</span>
<span class="co">#   Rotation="Rotation (degrees)",</span>
<span class="co">#   Translation="Translation (mm)"</span>
<span class="co">#   )</span>

<span class="co"># Summarize the motion rmse in the different cells</span>
<span class="va">pd2</span> <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>
<span class="va">directions_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries_collapsed</span>,
    <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">num_directions</span>, y<span class="op">=</span><span class="va">mean_rmse</span>,
        color<span class="op">=</span><span class="va">method</span>,
        shape<span class="op">=</span><span class="va">scheme_type</span>,
        linetype<span class="op">=</span><span class="va">denoiser</span>,
        group<span class="op">=</span><span class="va">method_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">mean_rmse</span><span class="op">+</span><span class="va">sd_rmse</span>, ymin<span class="op">=</span><span class="va">mean_rmse</span><span class="op">-</span><span class="va">sd_rmse</span><span class="op">)</span>, 
    position<span class="op">=</span><span class="va">pd2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="va">pd2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span>, <span class="st">"Eddy"</span><span class="op">)</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"None"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"MP-PCA"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMSE by Scheme Type"</span>, 
       y <span class="op">=</span> <span class="st">"Mean RMSE (±SD)"</span>, 
       x <span class="op">=</span> <span class="st">"Number of Directions"</span>, 
       color <span class="op">=</span> <span class="st">"Method"</span>,
       linetype<span class="op">=</span> <span class="st">"Denoising\nMethod"</span>,
       shape<span class="op">=</span><span class="st">"Scheme\nType"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">directions_plt</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-9-1.png" width="1152"></p>
<p>This is just another view of the previous plot, but interesting in that it clearly shows that SHORELine’s performance on the 55-direction CS-DSI scan is in the range of the performance on the ABCD multi shell scheme, which has almost twice as many directions. We can statistically test this, to be sure:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">error_rmse_dirs</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span>

<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">num_directions</span> <span class="op">&lt;-</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="fl">103</span>,
  HCP<span class="op">=</span><span class="fl">270</span>,
  DSIQ5<span class="op">=</span><span class="fl">257</span>,
  HASC55<span class="op">=</span><span class="fl">55</span><span class="op">)</span>

<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme_type</span> <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="st">"Shelled"</span>,
  HCP<span class="op">=</span><span class="st">"Shelled"</span>,
  DSIQ5<span class="op">=</span><span class="st">"Non-Shelled"</span>,
  HASC55<span class="op">=</span><span class="st">"Non-Shelled"</span><span class="op">)</span>

<span class="co"># Convert to percentage values</span>
<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">percent_motion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">percent_motion</span><span class="op">]</span><span class="op">)</span>

<span class="va">error_rmse_dirs</span> <span class="op">&lt;-</span> <span class="va">error_rmse_dirs</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># make it presentable for the table</span>
  <span class="fu">mutate</span><span class="op">(</span>
    Denoising <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">denoising</span> <span class="op">==</span> <span class="st">"dwidenoise"</span>  <span class="op">~</span> <span class="st">"MP-PCA"</span>,
      <span class="cn">TRUE</span>                       <span class="op">~</span> <span class="st">"None"</span>
    <span class="op">)</span>,
    `Scheme Type` <span class="op">=</span> <span class="va">scheme_type</span>,
    `% Motion` <span class="op">=</span> <span class="va">percent_motion</span>,
    RMSE <span class="op">=</span> <span class="va">rmse</span>,
    `N. Directions` <span class="op">=</span> <span class="va">num_directions</span>
  <span class="op">)</span>

<span class="co"># run lm</span>
<span class="va">rotation_shell_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">RMSE</span> <span class="op">~</span> <span class="va">`Scheme Type`</span> <span class="op">*</span> <span class="va">`N. Directions`</span> <span class="op">+</span> <span class="va">Denoising</span> <span class="op">+</span> <span class="va">`% Motion`</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">error_rmse_dirs</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span>

<span class="va">translation_shell_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">RMSE</span> <span class="op">~</span> <span class="va">`Scheme Type`</span> <span class="op">*</span> <span class="va">`N. Directions`</span><span class="op">+</span> <span class="va">Denoising</span> <span class="op">+</span> <span class="va">`% Motion`</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">error_rmse_dirs</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Translation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create gt tables</span>
<span class="va">translation_rmse_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">translation_shell_model</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span>

<span class="va">rotation_rmse_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">rotation_shell_model</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">capt</span> <span class="op">&lt;-</span> <span class="st">"**Supplementary Listing 1: _Factors Impacting RMSE Following Head Motion Correction_**. Error following motion correction is largely due to uncontrolled factors (presupposed head motion), preprocessing choices (use of denoising), and experimental design (sampling scheme)."</span>

<span class="co"># merge and display</span>

<span class="va">rmse_model_table</span> <span class="op">&lt;-</span> <span class="fu">tbl_merge</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">translation_rmse_tab</span>, <span class="va">rotation_rmse_tab</span><span class="op">)</span>, tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Translation"</span>, <span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>n_sigfig <span class="op">=</span> <span class="fl">2</span>, <span class="fu">matches</span><span class="op">(</span><span class="st">"Beta"</span><span class="op">)</span>, force_sign <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Predicting RMSE of Estimated Motion"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Denoising, Number of Directions, and Percent Motion, including interactions with Shell Scheme Type"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># tab_source_note(md(capt)) %&gt;%</span>
  <span class="co"># tab_style(</span>
  <span class="co">#   style = cell_text(</span>
  <span class="co">#     size = "large"</span>
  <span class="co">#   ),</span>
  <span class="co">#   locations = cells_source_notes()</span>
  <span class="co"># ) %&gt;%</span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_model_table</span></code></pre></div>
<div id="plvatiiikx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#plvatiiikx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#plvatiiikx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plvatiiikx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#plvatiiikx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#plvatiiikx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plvatiiikx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#plvatiiikx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#plvatiiikx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#plvatiiikx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#plvatiiikx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#plvatiiikx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#plvatiiikx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#plvatiiikx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#plvatiiikx .gt_from_md > :first-child {
  margin-top: 0;
}

#plvatiiikx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#plvatiiikx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#plvatiiikx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#plvatiiikx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#plvatiiikx .gt_row_group_first td {
  border-top-width: 2px;
}

#plvatiiikx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#plvatiiikx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#plvatiiikx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#plvatiiikx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plvatiiikx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#plvatiiikx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#plvatiiikx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#plvatiiikx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#plvatiiikx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plvatiiikx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#plvatiiikx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#plvatiiikx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#plvatiiikx .gt_left {
  text-align: left;
}

#plvatiiikx .gt_center {
  text-align: center;
}

#plvatiiikx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#plvatiiikx .gt_font_normal {
  font-weight: normal;
}

#plvatiiikx .gt_font_bold {
  font-weight: bold;
}

#plvatiiikx .gt_font_italic {
  font-style: italic;
}

#plvatiiikx .gt_super {
  font-size: 65%;
}

#plvatiiikx .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#plvatiiikx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#plvatiiikx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#plvatiiikx .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#plvatiiikx .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#plvatiiikx .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="7" class="gt_heading gt_title gt_font_normal" style>Predicting RMSE of Estimated Motion</th>
    </tr>
<tr>
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Denoising, Number of Directions, and Percent Motion, including interactions with Shell Scheme Type</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Translation</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Rotation</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">0.528</td>
<td class="gt_row gt_center">0.487, 0.569</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">1.125</td>
<td class="gt_row gt_center">1.019, 1.231</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme Type</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Shelled</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Non-Shelled</td>
<td class="gt_row gt_center">0.115</td>
<td class="gt_row gt_center">0.068, 0.161</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.278</td>
<td class="gt_row gt_center">-0.398, -0.157</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">N. Directions</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, -0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.004</td>
<td class="gt_row gt_center">-0.005, -0.004</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">0.060</td>
<td class="gt_row gt_center">0.039, 0.081</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.335</td>
<td class="gt_row gt_center">0.280, 0.391</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">% Motion</td>
<td class="gt_row gt_center">0.013</td>
<td class="gt_row gt_center">0.012, 0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.021</td>
<td class="gt_row gt_center">0.019, 0.023</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme Type * N. Directions</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Non-Shelled * N. Directions</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, 0.000</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.001</td>
<td class="gt_row gt_center">0.001, 0.002</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="7">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save</span>
<span class="va">rmse_model_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gtsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"figures"</span>, <span class="st">"rmse_model.pdf"</span><span class="op">)</span>, zoom<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<embed src="/tmp/Rtmptxnn7a/file43c728052940/articles/dmri_hmc_benchmark_files/figure-html/unnamed-chunk-12-1.pdf" width="1152" type="application/pdf"></embed><p>A couple interesting results come out here along with some obvious ones. First, there is a main effect of the number of directions. The more directions, the smaller the RMSE.</p>
</div>
<div class="section level3">
<h3 id="head-to-head-comparison-of-shoreline-vs-eddy">4 Head to head comparison of SHORELine vs Eddy<a class="anchor" aria-label="anchor" href="#head-to-head-comparison-of-shoreline-vs-eddy"></a>
</h3>
<p>The ABCD and HCP sequences are the only two schemes we tested that can be processed by both Eddy and SHORELine.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Match the Eddy and SHORELine errors </span>
<span class="va">paired_error</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">mean_error</span>, <span class="op">-</span><span class="va">sd_error</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">scheme</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABCD"</span>, <span class="st">"HCP"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">rmse</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">mutate</span><span class="op">(</span>shore_difference<span class="op">=</span><span class="va">method_Eddy</span> <span class="op">-</span> <span class="va">method_SHORELine</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># make it presentable for the table</span>
  <span class="fu">mutate</span><span class="op">(</span>
    Denoising <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
      <span class="va">denoising</span> <span class="op">==</span> <span class="st">"dwidenoise"</span>  <span class="op">~</span> <span class="st">"MP-PCA"</span>,
      <span class="cn">TRUE</span>                       <span class="op">~</span> <span class="st">"None"</span>
    <span class="op">)</span>,
    Scheme <span class="op">=</span> <span class="va">scheme</span>,
    `Motion Type` <span class="op">=</span> <span class="va">motion.type</span>,
    `% Motion` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">percent_motion</span><span class="op">]</span>
  <span class="op">)</span>

<span class="va">rotation_rmse_model_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">shore_difference</span> <span class="op">~</span> <span class="va">Scheme</span> <span class="op">*</span> <span class="va">Denoising</span> <span class="op">*</span> <span class="va">`% Motion`</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">paired_error</span>, <span class="va">`Motion Type`</span><span class="op">==</span><span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span>

<span class="va">translation_rmse_model_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">shore_difference</span> <span class="op">~</span> <span class="va">Scheme</span> <span class="op">*</span> <span class="va">Denoising</span> <span class="op">*</span> <span class="va">`% Motion`</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">paired_error</span>, <span class="va">`Motion Type`</span><span class="op">==</span><span class="st">"Translation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">translation_rmse_paired_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">translation_rmse_model_paired</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span>

<span class="va">rotation_rmse_paired_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">rotation_rmse_model_paired</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">capt</span> <span class="op">&lt;-</span> <span class="st">"**Supplementary Listing 2: _Comparing Eddy &amp; SHORELine RMSE_**. The SHORELine RMSE value was subtracted from the Eddy RMSE from each simulated scan, and this difference was the outcome variable of the model. Positive Beta estimates suggest better performance by SHORELine. SHORELine shows less error than Eddy for all scenarios without denoising, but Eddy showed slightly superior performence when data was first denoised with MP-PCA."</span>

<span class="fu">tbl_merge</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">translation_rmse_paired_tab</span>, <span class="va">rotation_rmse_paired_tab</span><span class="op">)</span>, tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Translation"</span>, <span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>n_sigfig <span class="op">=</span> <span class="fl">2</span>, <span class="fu">matches</span><span class="op">(</span><span class="st">"Beta"</span><span class="op">)</span>, force_sign <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Predicting RMSE Difference (Eddy — SHORELine) in ABCD &amp; HCP Schemes"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Denoising &amp; Percent Motion, and interactions with Shell Scheme"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># tab_source_note(md(capt)) %&gt;%</span>
  <span class="co"># tab_style(</span>
  <span class="co">#   style = cell_text(</span>
  <span class="co">#     size = "large"</span>
  <span class="co">#   ),</span>
  <span class="co">#   locations = cells_source_notes()</span>
  <span class="co"># ) %&gt;% </span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">rmse_difference_table</span></code></pre></div>
<pre><code><span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_difference_table</span></code></pre></div>
<div id="rentkzejex" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rentkzejex .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rentkzejex .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rentkzejex .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rentkzejex .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rentkzejex .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rentkzejex .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rentkzejex .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rentkzejex .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rentkzejex .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rentkzejex .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rentkzejex .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rentkzejex .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rentkzejex .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rentkzejex .gt_from_md > :first-child {
  margin-top: 0;
}

#rentkzejex .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rentkzejex .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rentkzejex .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rentkzejex .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rentkzejex .gt_row_group_first td {
  border-top-width: 2px;
}

#rentkzejex .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rentkzejex .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rentkzejex .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rentkzejex .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rentkzejex .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rentkzejex .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rentkzejex .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rentkzejex .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rentkzejex .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rentkzejex .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rentkzejex .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rentkzejex .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rentkzejex .gt_left {
  text-align: left;
}

#rentkzejex .gt_center {
  text-align: center;
}

#rentkzejex .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rentkzejex .gt_font_normal {
  font-weight: normal;
}

#rentkzejex .gt_font_bold {
  font-weight: bold;
}

#rentkzejex .gt_font_italic {
  font-style: italic;
}

#rentkzejex .gt_super {
  font-size: 65%;
}

#rentkzejex .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#rentkzejex .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rentkzejex .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rentkzejex .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#rentkzejex .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#rentkzejex .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="7" class="gt_heading gt_title gt_font_normal" style>Predicting RMSE Difference (Eddy — SHORELine) in ABCD &amp; HCP Schemes</th>
    </tr>
<tr>
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Denoising &amp; Percent Motion, and interactions with Shell Scheme</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Translation</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Rotation</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">0.129</td>
<td class="gt_row gt_center">0.042, 0.216</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.004</td>
<td class="gt_row gt_center">0.297</td>
<td class="gt_row gt_center">0.056, 0.538</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.016</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">0.059</td>
<td class="gt_row gt_center">-0.065, 0.182</td>
<td class="gt_row gt_center">0.3</td>
<td class="gt_row gt_center">0.254</td>
<td class="gt_row gt_center">-0.087, 0.595</td>
<td class="gt_row gt_center">0.14</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">0.302</td>
<td class="gt_row gt_center">0.178, 0.425</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.512</td>
<td class="gt_row gt_center">0.171, 0.853</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.003</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">% Motion</td>
<td class="gt_row gt_center">-0.007</td>
<td class="gt_row gt_center">-0.009, -0.004</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.037</td>
<td class="gt_row gt_center">-0.044, -0.030</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme * Denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * None</td>
<td class="gt_row gt_center">-0.286</td>
<td class="gt_row gt_center">-0.460, -0.112</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.001</td>
<td class="gt_row gt_center">-0.215</td>
<td class="gt_row gt_center">-0.697, 0.267</td>
<td class="gt_row gt_center">0.4</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme * % Motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * % Motion</td>
<td class="gt_row gt_center">0.006</td>
<td class="gt_row gt_center">0.003, 0.010</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.011</td>
<td class="gt_row gt_center">0.001, 0.020</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.034</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Denoising * % Motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None * % Motion</td>
<td class="gt_row gt_center">0.002</td>
<td class="gt_row gt_center">-0.001, 0.006</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">0.033</td>
<td class="gt_row gt_center">0.023, 0.043</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme * Denoising * % Motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * None * % Motion</td>
<td class="gt_row gt_center">-0.003</td>
<td class="gt_row gt_center">-0.008, 0.002</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">-0.028</td>
<td class="gt_row gt_center">-0.042, -0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="7">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_difference_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gtsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"figures"</span>, <span class="st">"rmse_diff_model.pdf"</span><span class="op">)</span>, zoom<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<embed src="/tmp/Rtmptxnn7a/file43c728052940/articles/dmri_hmc_benchmark_files/figure-html/unnamed-chunk-16-1.pdf" width="1152" type="application/pdf"></embed><p>We plot the RMSE differences:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">paired_error</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, 
           y<span class="op">=</span><span class="va">shore_difference</span>,
           fill<span class="op">=</span><span class="va">denoising</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_halfeye</span><span class="op">(</span>
    justification <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>,
    alpha <span class="op">=</span> <span class="fl">0.8</span>,
    .width <span class="op">=</span> <span class="fl">0</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>
    width <span class="op">=</span> <span class="fl">.12</span>, 
    outlier.shape <span class="op">=</span> <span class="cn">NA</span> <span class="co">## `outlier.shape = NA` works as well</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="co"># geom_point(</span>
  <span class="co">#   ## draw horizontal lines instead of points</span>
  <span class="co">#   shape = 95,</span>
  <span class="co">#   size = 10,</span>
  <span class="co">#   alpha = 0.2,</span>
  <span class="co"># ) +</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MP-PCA"</span>, <span class="st">"None"</span><span class="op">)</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dwidenoise"</span><span class="op">=</span><span class="st">"#FFC20A"</span>, <span class="st">"none"</span><span class="op">=</span><span class="st">"#0C7BDC"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Differences in Estimate Error (Eddy - SHORELine)"</span>,
    y <span class="op">=</span> <span class="st">"Estimation Error Difference"</span>,
    x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>,
    fill<span class="op">=</span><span class="st">"Denoising\nMethod"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-17-1.png" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="qc-metric-comparisons-between-shoreline-and-eddy">QC metric comparisons between SHORELine and Eddy<a class="anchor" aria-label="anchor" href="#qc-metric-comparisons-between-shoreline-and-eddy"></a>
</h2>
<p>While accurately estimating head motion parameters is important, head motion is not the only artifact present in the simulated data. Other factors like eddy current distortion can impact the final quality of the results.</p>
<p>We therefore calculated and compared the Neighboring DWI Correlation (NDC) and FWHM of the final outputs between the two methods. The NDC and FWHM of the results are related, so we used the same method as in Cieslak et al. 2021 where FWHM is partialled out from the NDC measurements.</p>
<div class="section level3">
<h3 id="test-the-settings">1. Test the Settings<a class="anchor" aria-label="anchor" href="#test-the-settings"></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"qc_df"</span><span class="op">)</span></code></pre></div>
<p>Above we tested the settings to see if Linear/Quadratic or Rigid/Affine made a difference on motion estimation accuracy. Linear/Quadratic showed no difference, but Rigid performed better than Affine.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rename</span><span class="op">(</span>hmc_method<span class="op">=</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">hmc_method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">do</span><span class="op">(</span>test <span class="op">=</span> <span class="fu">tidy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">ndc.corrected</span> <span class="op">~</span> <span class="va">setting</span>, data<span class="op">=</span><span class="va">.</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">test</span><span class="op">)</span>

<span class="co"># Adjust the p-values and order them by the largest absolute effects</span>
<span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>p.value.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># significant.effects &lt;- subset(setting_tests, (p.value.adj &lt; 0.01))</span>
<span class="co"># significant.effects[order(-abs(significant.effects$estimate)),]</span>

<span class="va">setting_tests_gt</span> <span class="op">&lt;-</span> <span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parameter</span>, <span class="va">method</span>, <span class="va">alternative</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span>Method <span class="op">=</span> <span class="va">hmc_method</span>, Scheme <span class="op">=</span> <span class="va">scheme</span>, Denoising <span class="op">=</span> <span class="va">denoising</span>, <span class="va">percent_motion</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">Method</span>, <span class="va">Scheme</span>, <span class="va">Denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># convert to char for empty strings &amp;</span>
  <span class="co"># insert empty strings for every group where the values are duplicated</span>
  <span class="co"># for clarity</span>
  
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Method</span>, <span class="va">Scheme</span>, <span class="va">Denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">Method</span><span class="op">:</span><span class="va">Denoising</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># precision for the confidence intervals that get merged</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># last details</span>
  <span class="fu">mutate</span><span class="op">(</span>Denoising <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Denoising</span> <span class="op">==</span> <span class="st">"none"</span>, <span class="st">"None"</span>, <span class="st">"DWIDenoise"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">p.value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>pval_marker <span class="op">=</span> <span class="va">p.value.adj</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, <span class="st">" %"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="fu">gt</span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">"Scheme"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">setting_tests_gt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_merge</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"[{1}, {2}]"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    conf.low <span class="op">=</span> <span class="st">"95% CI"</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt</span><span class="op">(</span>
    columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"p.value.adj"</span><span class="op">)</span>,
    fns <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html" class="external-link">format.pval</a></span><span class="op">(</span><span class="va">x</span>, eps<span class="op">=</span><span class="fl">0.0001</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_style</span><span class="op">(</span>
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
      <span class="op">)</span>,
    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>columns <span class="op">=</span> <span class="va">p.value.adj</span>, rows <span class="op">=</span> <span class="va">pval_marker</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>
    columns <span class="op">=</span> <span class="fu">matches</span><span class="op">(</span><span class="st">"statistic|estimate"</span><span class="op">)</span>,
    decimals <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    p.value.adj <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Adj. *p*-value"</span><span class="op">)</span>,
    estimate <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Estimate"</span><span class="op">)</span>,
    statistic <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"Statistic"</span><span class="op">)</span>,
    percent_motion <span class="op">=</span> <span class="fu">md</span><span class="op">(</span><span class="st">"% Motion"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_style</span><span class="op">(</span>
    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>
      <span class="op">)</span>,
    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span></code></pre></div>
<div id="awhpuxlulp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#awhpuxlulp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#awhpuxlulp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#awhpuxlulp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#awhpuxlulp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#awhpuxlulp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#awhpuxlulp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#awhpuxlulp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#awhpuxlulp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#awhpuxlulp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#awhpuxlulp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#awhpuxlulp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#awhpuxlulp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#awhpuxlulp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#awhpuxlulp .gt_from_md > :first-child {
  margin-top: 0;
}

#awhpuxlulp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#awhpuxlulp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#awhpuxlulp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#awhpuxlulp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#awhpuxlulp .gt_row_group_first td {
  border-top-width: 2px;
}

#awhpuxlulp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#awhpuxlulp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#awhpuxlulp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#awhpuxlulp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#awhpuxlulp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#awhpuxlulp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#awhpuxlulp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#awhpuxlulp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#awhpuxlulp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#awhpuxlulp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#awhpuxlulp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#awhpuxlulp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#awhpuxlulp .gt_left {
  text-align: left;
}

#awhpuxlulp .gt_center {
  text-align: center;
}

#awhpuxlulp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#awhpuxlulp .gt_font_normal {
  font-weight: normal;
}

#awhpuxlulp .gt_font_bold {
  font-weight: bold;
}

#awhpuxlulp .gt_font_italic {
  font-style: italic;
}

#awhpuxlulp .gt_super {
  font-size: 65%;
}

#awhpuxlulp .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#awhpuxlulp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#awhpuxlulp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#awhpuxlulp .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#awhpuxlulp .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#awhpuxlulp .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;">Method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;">Denoising</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;">% Motion</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">Adj. <em>p</em>-value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;">pval_marker</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.014</td>
<td class="gt_row gt_right">11.039</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">2.139571e-10</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.014</td>
<td class="gt_row gt_right">8.523</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">6.077568e-08</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.015</td>
<td class="gt_row gt_right">6.856</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">4.233490e-06</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.015</td>
<td class="gt_row gt_right">8.628</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">4.985773e-08</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.015</td>
<td class="gt_row gt_right">10.274</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">1.103746e-09</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.015</td>
<td class="gt_row gt_right">5.777</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">7.644406e-05</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.017</td>
<td class="gt_row gt_right">30.747</td>
<td class="gt_row gt_right">[0.02, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">3.959222e-22</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.017</td>
<td class="gt_row gt_right">22.830</td>
<td class="gt_row gt_right">[0.02, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">1.546363e-18</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.017</td>
<td class="gt_row gt_right">12.757</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">6.663808e-12</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.018</td>
<td class="gt_row gt_right">13.572</td>
<td class="gt_row gt_right">[0.02, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">1.462861e-12</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.017</td>
<td class="gt_row gt_right">8.632</td>
<td class="gt_row gt_right">[0.01, 0.02]</td>
<td class="gt_row gt_right" style="font-weight: bold;">&lt;1e-04</td>
<td class="gt_row gt_right">4.985773e-08</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.013</td>
<td class="gt_row gt_right">2.480</td>
<td class="gt_row gt_right">[0.00, 0.02]</td>
<td class="gt_row gt_right">0.460</td>
<td class="gt_row gt_right">4.604508e-01</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">DSIQ5</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">−0.001</td>
<td class="gt_row gt_right">−0.506</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.005</td>
<td class="gt_row gt_right">2.308</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">0.651</td>
<td class="gt_row gt_right">6.509969e-01</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.007</td>
<td class="gt_row gt_right">2.954</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">0.154</td>
<td class="gt_row gt_right">1.541114e-01</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">DSIQ5</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">0.805</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.005</td>
<td class="gt_row gt_right">1.371</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.007</td>
<td class="gt_row gt_right">2.086</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HASC55</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.723</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">0.819</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.392</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HASC55</td>
<td class="gt_row gt_left">SHORELine</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.014</td>
<td class="gt_row gt_right">1.248</td>
<td class="gt_row gt_right">[-0.01, 0.04]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">0.796</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">0.681</td>
<td class="gt_row gt_right">[0.00, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left">Eddy</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">−0.001</td>
<td class="gt_row gt_right">−0.399</td>
<td class="gt_row gt_right">[-0.01, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">−0.193</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">−0.159</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">ABCD</td>
<td class="gt_row gt_left">Eddy</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.185</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.253</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">−0.039</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left">Eddy</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">−0.003</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">0.473</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.574</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub">HCP</td>
<td class="gt_row gt_left">Eddy</td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">15 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.097</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">30 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">−0.099</td>
<td class="gt_row gt_right">[0.00, 0.00]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
<tr>
<td class="gt_row gt_right gt_stub"></td>
<td class="gt_row gt_left"></td>
<td class="gt_row gt_left">DWIDenoise</td>
<td class="gt_row gt_left">50 %</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">[-0.01, 0.01]</td>
<td class="gt_row gt_right">1.000</td>
<td class="gt_row gt_right">1.000000e+00</td>
</tr>
</tbody>
</table>
</div>
<p>Recall here we’re testing NDC, which is better when higher. The t-tests work the same way here as they did above: all the significant effects are for SHORELine and the estimates are positive. This means that Affine NDC is higher than Rigid NDC. Although these effects are absolutely tiny, they have a different direction than the RMSE tests: Affine produces higher QC metrics than Rigid, while Rigid is more accurate at estimating head motion than Affine.</p>
<p>To be consistent with the above tests, we will use Rigid for the QC comparisons. Rigid is also remarkably faster than Affine, and could be the first step of a more powerful Eddy Current correction later.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">setting</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rigid"</span>, <span class="st">"Quadratic"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">setting</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-does-the-fwhm-compare">2. How does the fwhm compare?<a class="anchor" aria-label="anchor" href="#how-does-the-fwhm-compare"></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fwhm_smooth_plot</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, y<span class="op">=</span><span class="va">fwhm</span>, fill<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_halfeye</span><span class="op">(</span>
    justification <span class="op">=</span> <span class="op">-</span><span class="fl">.2</span>,
    alpha <span class="op">=</span> <span class="fl">0.8</span>,
    .width <span class="op">=</span> <span class="fl">0</span>, 
    point_colour <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>
    position <span class="op">=</span> <span class="fu">position_dodge2</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">5</span>, preserve <span class="op">=</span> <span class="st">"single"</span>, padding<span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">.12</span>,
    alpha <span class="op">=</span> <span class="fl">0.8</span>,
    outlier.shape <span class="op">=</span> <span class="cn">NA</span> <span class="co">## `outlier.shape = NA` works as well</span>
  <span class="op">)</span> <span class="op">+</span>

  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Times"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Spatial Smoothness (FWHM)"</span>, 
       y <span class="op">=</span> <span class="st">"FWHM (mm)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">scheme</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fwhm_smooth_plot</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-20-1.png" width="1152"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"vignettes"</span>,<span class="st">"fwhm_smooth_plot.svg"</span><span class="op">)</span>,
       plot<span class="op">=</span><span class="va">fwhm_smooth_plot</span>,
       height<span class="op">=</span><span class="fl">3</span>,
       width<span class="op">=</span><span class="fl">7.9</span>,
       units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What about if we make a paired comparison?</span>
<span class="va">id_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scheme"</span>, <span class="st">"iternum"</span>, <span class="st">"method"</span>, <span class="st">"denoising"</span>, <span class="st">"percent_motion"</span><span class="op">)</span>

<span class="va">paired_fwhm</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu">one_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id_cols</span>, <span class="st">"fwhm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">fwhm</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>fwhm_diff<span class="op">=</span><span class="va">method_SHORELine</span> <span class="op">-</span> <span class="va">method_Eddy</span>,
         percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"method_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># make it presentable for the table</span>
  <span class="fu">mutate</span><span class="op">(</span>
    Denoising <span class="op">=</span> <span class="va">denoising</span>,
    Scheme <span class="op">=</span> <span class="va">scheme</span>,
    `% Motion` <span class="op">=</span> <span class="va">percent_motion</span>
  <span class="op">)</span>
  
  
<span class="va">fwhm_diff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">fwhm_diff</span> <span class="op">~</span> <span class="va">`% Motion`</span> <span class="op">+</span> <span class="va">Scheme</span> <span class="op">+</span> <span class="va">Denoising</span>,
  data<span class="op">=</span><span class="va">paired_fwhm</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">capt</span> <span class="op">&lt;-</span> <span class="st">"**Supplementary Listing 3: Evaluating Smoothness of Preprocessed Data Following Head Motion Correction Quantified by FWHM.** The SHORELine FWHM value was subtracted from the Eddy FWHM, and this difference was the outcome variable of the model. Across all sampling schemes and method correction methods, more motion is associated with greater smoothness in output images. SHORELine produced significantly sharper outputs than Eddy."</span>

<span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">fwhm_diff_model</span>,
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Predicting FWHM (Eddy — Shoreline) of Each Scan"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Percent Motion, Scheme, and Denoising"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co"># tab_source_note(md(capt)) %&gt;%</span>
  <span class="co"># tab_style(</span>
  <span class="co">#   style = cell_text(</span>
  <span class="co">#     size = "large"</span>
  <span class="co">#   ),</span>
  <span class="co">#   locations = cells_source_notes()</span>
  <span class="co"># ) %&gt;% </span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">fwhm_model</span></code></pre></div>
<pre><code><span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fwhm_model</span></code></pre></div>
<div id="znriaziuki" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#znriaziuki .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#znriaziuki .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znriaziuki .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#znriaziuki .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#znriaziuki .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znriaziuki .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znriaziuki .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#znriaziuki .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#znriaziuki .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#znriaziuki .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#znriaziuki .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#znriaziuki .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#znriaziuki .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#znriaziuki .gt_from_md > :first-child {
  margin-top: 0;
}

#znriaziuki .gt_from_md > :last-child {
  margin-bottom: 0;
}

#znriaziuki .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#znriaziuki .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#znriaziuki .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#znriaziuki .gt_row_group_first td {
  border-top-width: 2px;
}

#znriaziuki .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znriaziuki .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#znriaziuki .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#znriaziuki .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znriaziuki .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znriaziuki .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#znriaziuki .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#znriaziuki .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znriaziuki .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znriaziuki .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znriaziuki .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znriaziuki .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znriaziuki .gt_left {
  text-align: left;
}

#znriaziuki .gt_center {
  text-align: center;
}

#znriaziuki .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#znriaziuki .gt_font_normal {
  font-weight: normal;
}

#znriaziuki .gt_font_bold {
  font-weight: bold;
}

#znriaziuki .gt_font_italic {
  font-style: italic;
}

#znriaziuki .gt_super {
  font-size: 65%;
}

#znriaziuki .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#znriaziuki .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#znriaziuki .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#znriaziuki .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#znriaziuki .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#znriaziuki .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="4" class="gt_heading gt_title gt_font_normal" style>Predicting FWHM (Eddy — Shoreline) of Each Scan</th>
    </tr>
<tr>
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Percent Motion, Scheme, and Denoising</th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">-0.060</td>
<td class="gt_row gt_center">-0.083, -0.036</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">% Motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">15</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">30</td>
<td class="gt_row gt_center">-0.086</td>
<td class="gt_row gt_center">-0.111, -0.060</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">50</td>
<td class="gt_row gt_center">-0.199</td>
<td class="gt_row gt_center">-0.225, -0.174</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">0.018</td>
<td class="gt_row gt_center">-0.002, 0.039</td>
<td class="gt_row gt_center">0.084</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">-0.009</td>
<td class="gt_row gt_center">-0.030, 0.012</td>
<td class="gt_row gt_center">0.4</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fwhm_model</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gtsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"figures"</span>, <span class="st">"fwhm_model.pdf"</span><span class="op">)</span>, zoom<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<embed src="/tmp/Rtmptxnn7a/file43c728052940/articles/dmri_hmc_benchmark_files/figure-html/unnamed-chunk-24-1.pdf" width="1152" type="application/pdf"></embed>
</div>
<div class="section level3">
<h3 id="comparing-fwhm-corrected-ndc-between-shoreline-and-eddy">3. Comparing FWHM-corrected NDC between SHORELine and Eddy<a class="anchor" aria-label="anchor" href="#comparing-fwhm-corrected-ndc-between-shoreline-and-eddy"></a>
</h3>
<p>Does one of the methods have higher NDC scores? Also what is the improvement in NDC relative to the raw data? We know that higher percent motion will cause lower NDC scores in the unprocessed data.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">improved_ndc_summaries</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span>, 
            sd_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span>, 
            se_ndc<span class="op">=</span><span class="va">sd_ndc</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span><span class="op">)</span>,
            group_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span>,
            sd_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">improved_ndc_summaries</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="st">'NDC Change\nFrom Raw'</span>
<span class="va">ndc_summaries</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span>, 
            sd_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span>, 
            se_ndc<span class="op">=</span><span class="va">sd_ndc</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span><span class="op">)</span>,
            group_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span>,
            sd_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_summaries</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="st">'Preprocessed NDC'</span>
<span class="va">qc_summaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ndc_summaries</span>, <span class="va">improved_ndc_summaries</span><span class="op">)</span>
<span class="va">qc_summaries</span><span class="op">$</span><span class="va">percent_motion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">qc_summaries</span><span class="op">$</span><span class="va">percent_motion</span><span class="op">)</span>
<span class="va">qc_summaries</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">qc_summaries</span><span class="op">$</span><span class="va">measure</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Preprocessed NDC'</span>, <span class="st">'NDC Change\nFrom Raw'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pd</span><span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.6</span>, preserve<span class="op">=</span><span class="st">"single"</span><span class="op">)</span>
<span class="va">ndc_mean_plt</span> <span class="op">&lt;-</span>  
  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">qc_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>
      y<span class="op">=</span><span class="va">group_mean_ndc</span>, x<span class="op">=</span><span class="va">percent_motion</span>, 
      fill<span class="op">=</span><span class="va">method</span>, group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">denoising</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_bar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>alpha<span class="op">=</span><span class="va">denoising</span><span class="op">)</span>, stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="va">pd</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">group_mean_ndc</span><span class="op">+</span><span class="va">sd_ndc</span>, ymin<span class="op">=</span><span class="va">group_mean_ndc</span><span class="op">-</span><span class="va">sd_ndc</span>,
        width<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="st">"black"</span>, position<span class="op">=</span><span class="va">pd</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">measure</span><span class="op">~</span><span class="va">scheme</span>, scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_alpha_manual</span><span class="op">(</span>
    name<span class="op">=</span><span class="st">"Denoising Strategy"</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span>
    <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>strip.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"QC Measure"</span>, 
       y <span class="op">=</span> <span class="st">"Neighboring DWI Correlation"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>,
       fill <span class="op">=</span> <span class="st">"Method"</span>
       <span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>linetype<span class="op">=</span><span class="fu">guide_legend</span><span class="op">(</span>override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_mean_plt</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-26-1.png" width="1152"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"vignettes"</span>,<span class="st">"ndc_mean_plot.svg"</span><span class="op">)</span>,
       plot<span class="op">=</span><span class="va">ndc_mean_plt</span>,
       height<span class="op">=</span><span class="fl">3.5</span>,
       width<span class="op">=</span><span class="fl">7.9</span>,
       units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></code></pre></div>
<p>The NDC scores in and of themselves don’t mean much across sampling schemes, but are comparable within sampling schemes. The top row shows that MP-PCA improves NDC scores across the board and also that Eddy has a small advantage in the two shelled schemes where it can be used.</p>
<p>The second row shows the percent improvement in NDC relative to the raw scans. This is pretty remarkable. To do statistical tests, we will center the raw NDC <em>within</em> their percent motion category</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">qc_df</span>, <span class="va">scheme</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABCD"</span>, <span class="st">"HCP"</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">qc_df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, y<span class="op">=</span><span class="va">raw_neighbor_corr</span>, color<span class="op">=</span><span class="va">scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Unprocessed data NDC values"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-28-1.png" width="1152"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
   <span class="fu">group_by</span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
   <span class="fu">mutate</span><span class="op">(</span>pct_motion_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">raw_neighbor_corr</span><span class="op">)</span>,
          centered_raw_ndc<span class="op">=</span><span class="va">raw_neighbor_corr</span> <span class="op">-</span> <span class="va">pct_motion_mean</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">qc_df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, y<span class="op">=</span><span class="va">centered_raw_ndc</span>, color<span class="op">=</span><span class="va">scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Unprocessed data NDC values: Centered by percent motion"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/center_raw_ndc-1.png" width="1152"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">paired_ndc</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu">one_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id_cols</span>, <span class="st">"ndc.corrected"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">ndc.corrected</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>ndc_diff<span class="op">=</span><span class="va">method_SHORELine</span> <span class="op">-</span> <span class="va">method_Eddy</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"method_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="co"># make it presentable for the table</span>
  <span class="fu">mutate</span><span class="op">(</span>
    Denoising <span class="op">=</span> <span class="va">denoising</span>,
    Scheme <span class="op">=</span> <span class="va">scheme</span>,
    `% Motion` <span class="op">=</span> <span class="va">percent_motion</span>
  <span class="op">)</span>

<span class="va">ndc_diff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">ndc_diff</span> <span class="op">~</span> <span class="va">`% Motion`</span> <span class="op">+</span> <span class="va">Denoising</span> <span class="op">+</span> <span class="va">Scheme</span>,
  data<span class="op">=</span><span class="va">paired_ndc</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">ndc_diff_model</span>,
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"NDC Model"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="co">#tab_source_note(md("*This data is simulated*")) %&gt;%</span>
  <span class="fu">opt_table_font</span><span class="op">(</span><span class="st">"Helvetica"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">ndc_table</span></code></pre></div>
<pre><code><span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span>

<span class="co">## Warning: The `fmt_missing()` function is deprecated and will soon be removed</span>
<span class="co">## * Use the `sub_missing()` function instead</span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_table</span></code></pre></div>
<div id="rqlmigqqfe" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: Helvetica, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rqlmigqqfe .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rqlmigqqfe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rqlmigqqfe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rqlmigqqfe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rqlmigqqfe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rqlmigqqfe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rqlmigqqfe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rqlmigqqfe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rqlmigqqfe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rqlmigqqfe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rqlmigqqfe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rqlmigqqfe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rqlmigqqfe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rqlmigqqfe .gt_from_md > :first-child {
  margin-top: 0;
}

#rqlmigqqfe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rqlmigqqfe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rqlmigqqfe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rqlmigqqfe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rqlmigqqfe .gt_row_group_first td {
  border-top-width: 2px;
}

#rqlmigqqfe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rqlmigqqfe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rqlmigqqfe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rqlmigqqfe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rqlmigqqfe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rqlmigqqfe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rqlmigqqfe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rqlmigqqfe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rqlmigqqfe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rqlmigqqfe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rqlmigqqfe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rqlmigqqfe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rqlmigqqfe .gt_left {
  text-align: left;
}

#rqlmigqqfe .gt_center {
  text-align: center;
}

#rqlmigqqfe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rqlmigqqfe .gt_font_normal {
  font-weight: normal;
}

#rqlmigqqfe .gt_font_bold {
  font-weight: bold;
}

#rqlmigqqfe .gt_font_italic {
  font-style: italic;
}

#rqlmigqqfe .gt_super {
  font-size: 65%;
}

#rqlmigqqfe .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#rqlmigqqfe .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rqlmigqqfe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rqlmigqqfe .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#rqlmigqqfe .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#rqlmigqqfe .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>NDC Model</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">-0.020</td>
<td class="gt_row gt_center">-0.026, -0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">% Motion</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, -0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">0.016</td>
<td class="gt_row gt_center">0.011, 0.020</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">Scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">-0.004</td>
<td class="gt_row gt_center">-0.008, 0.000</td>
<td class="gt_row gt_center">0.072</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_table</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">gtsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"figures"</span>, <span class="st">"ndc_model.pdf"</span><span class="op">)</span>, vwidth<span class="op">=</span><span class="fl">250</span>, vheight<span class="op">=</span><span class="fl">100</span><span class="op">)</span></code></pre></div>
<embed src="/tmp/Rtmptxnn7a/file43c728052940/articles/dmri_hmc_benchmark_files/figure-html/unnamed-chunk-30-1.pdf" width="1152" type="application/pdf"></embed>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew Ceislak.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
