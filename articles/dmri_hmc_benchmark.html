<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SHORELINEPaper">
<title>Head Motion Benchmark • SHORELINEPaper</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Head Motion Benchmark">
<meta property="og:description" content="SHORELINEPaper">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SHORELINEPaper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dmri_hmc_benchmark.html">Head Motion Benchmark</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="dmri_hmc_benchmark_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Head Motion Benchmark</h1>
            
            <h4 data-toc-skip class="date">2022-05-17</h4>
      
      
      <div class="d-none name"><code>dmri_hmc_benchmark.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="libraries-setup">Libraries &amp; Setup<a class="anchor" aria-label="anchor" href="#libraries-setup"></a>
</h2>
<p>The data are available on OSF at <a href="osf.io/7twne">this link</a>. This package internally downloads and cleans them for your convenience. They’re available preprocessed within the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"motion_df"</span><span class="op">)</span> <span class="co"># for viewing the preprocessed data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"error_rmse_wsetting"</span><span class="op">)</span> <span class="co"># for analysis of estimated motion</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample">Sample<a class="anchor" aria-label="anchor" href="#sample"></a>
</h2>
<p>The table below shows the number of <code>b0</code>’s for each scheme:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># TODO demonstrate the table in the paper</span>

<span class="co"># motion_df %&gt;%</span>
<span class="co"># filter(</span>
<span class="co">#   iternum == 1 &amp;</span>
<span class="co">#     method == "SHORELine" &amp;</span>
<span class="co">#     denoising == "none" &amp;</span>
<span class="co">#     bval &gt; 100 &amp;</span>
<span class="co">#     setting == "Affine") %&gt;%</span>
<span class="co">#    select(percent_motion, scheme) %&gt;%</span>
<span class="co">#    table()</span>

<span class="co"># motion_df %&gt;%</span>
<span class="co">#   mutate( Type = case_when(str_detect(scheme, "ABCD|HCP")  ~ "Shelled",</span>
<span class="co">#                      str_detect(scheme, "DSI")      ~ "Cartesian",</span>
<span class="co">#                      str_detect(scheme, "HASC")     ~ "Random"</span>
<span class="co">#                      )</span>
<span class="co">#     ) %&gt;%</span>
<span class="co">#   filter(</span>
<span class="co">#   iternum == 1 &amp;</span>
<span class="co">#     method == "SHORELine" &amp;</span>
<span class="co">#     denoising == "none" &amp;</span>
<span class="co">#     bval &gt; 100 &amp;</span>
<span class="co">#     setting == "Affine") %&gt;%</span>
<span class="co">#   group_by(scheme, Type) %&gt;%</span>
<span class="co">#   filter(bval &gt; 0)# %&gt;%</span>
  <span class="co">#summarise(bval_grth_0 = n(),</span>
  <span class="co">#          max_b = max(bval)) %&gt;%</span>
  
  <span class="co">#View()</span></code></pre></div>
<p>Errors for rotation are converted from radians to degrees, and we also extract only the <span class="math inline">\(b &gt; 0\)</span> volumes. Both Eddy and SHORELine use different methods (non-GP and non-SHORE) for motion-correcting these images.</p>
</div>
<div class="section level2">
<h2 id="motion-analysis">Motion Analysis<a class="anchor" aria-label="anchor" href="#motion-analysis"></a>
</h2>
<div class="section level3">
<h3 id="is-there-an-rmse-difference-between-the-rigidaffine-and-linearquadratic-settings">1. Is there an RMSE difference between the Rigid/Affine and Linear/Quadratic settings?<a class="anchor" aria-label="anchor" href="#is-there-an-rmse-difference-between-the-rigidaffine-and-linearquadratic-settings"></a>
</h3>
<p>We tested Rigid and Affine transformation models for SHORELine and Linear and Quadratic models in Eddy. In Eddy, the models only affect Eddy current correction we shouldn’t see a difference in head motion estimates. SHORELine may or may not benefit from having more degrees of freedom in the transformation model.</p>
<p>Here we test whether there are significant effects of transformation model. Under the hood R will pair the same scans and perform a paired t-test by subtracting alphabetically. For SHORELine this means Affine - Rigid and for Eddy it means Linear - Quadratic.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">error_rmse_wsetting</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rename</span><span class="op">(</span>hmc_method<span class="op">=</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">hmc_method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">do</span><span class="op">(</span>test <span class="op">=</span> <span class="fu">tidy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">rmse</span> <span class="op">~</span> <span class="va">setting</span>, data<span class="op">=</span><span class="va">.</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">test</span><span class="op">)</span>

<span class="co"># Adjust the p-values and order them by the largest absolute effects</span>
<span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>p_val_adjusted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_val_adjusted</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">motion.type</span>, <span class="va">scheme</span>, <span class="va">percent_motion</span>, <span class="va">denoising</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">motion.type</span>, <span class="va">scheme</span>, <span class="va">percent_motion</span>, <span class="va">denoising</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">hmc_method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">motion.type</span> <span class="op">==</span> <span class="st">"Rotation"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">setting_tests_rotation</span>

<span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>p_val_adjusted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_val_adjusted</span> <span class="op">&lt;</span> <span class="fl">0.01</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">motion.type</span>, <span class="va">scheme</span>, <span class="va">percent_motion</span>, <span class="va">denoising</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">motion.type</span>, <span class="va">scheme</span>, <span class="va">percent_motion</span>, <span class="va">denoising</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">hmc_method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">motion.type</span> <span class="op">!=</span> <span class="st">"Rotation"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">setting_tests_translation</span>

<span class="va">setting_tests_rotation</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">scheme</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>      <span class="co"># reorder columns</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># convert to char for empty strings</span>
  
  <span class="co"># insert empty strings for every group where the values are duplicated</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">scheme</span><span class="op">:</span><span class="va">percent_motion</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">scheme</span><span class="op">:</span><span class="va">statistic</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span>, <span class="va">p_val_adjusted</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># precision for the confidence intervals</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">estimate</span><span class="op">:</span><span class="va">conf.high</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  
  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># string format confidence intervals</span>
  <span class="fu">cols_merge</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"{1}, {2}"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    conf.low <span class="op">=</span> <span class="st">"95% CI"</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">setting_tests_rotation_gt</span>

<span class="va">setting_tests_translation</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">scheme</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">-</span><span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>      <span class="co"># reorder columns</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>  <span class="co"># convert to char for empty strings</span>
  
  <span class="co"># insert empty strings for every group where the values are duplicated</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate_at</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">scheme</span><span class="op">:</span><span class="va">percent_motion</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="va">scheme</span><span class="op">:</span><span class="va">statistic</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span>, <span class="va">p_val_adjusted</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># precision for the confidence intervals</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="va">estimate</span><span class="op">:</span><span class="va">conf.high</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  
  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  
  <span class="co"># string format confidence intervals</span>
  <span class="fu">cols_merge</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">conf.low</span>, <span class="va">conf.high</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"{1}, {2}"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">cols_label</span><span class="op">(</span>
    conf.low <span class="op">=</span> <span class="st">"95% CI"</span>
  <span class="op">)</span> <span class="op">-&gt;</span> <span class="va">setting_tests_translation_gt</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#tbl_merge(list(setting_tests_translation_gt, setting_tests_rotation_gt), tab_spanner = c("Translation", "Rotation"))</span></code></pre></div>
<p>We can see that all the effects are for SHORELine and the estimates are positive. This means that Affine RMSE is greater than Rigid RMSE. Although these estimates are all tiny, we will simplify subsequent comparisons by only choosing rigid. Rigid also has the benefit of much shorter run times than Affine. As expected, there are no differences for Eddy.</p>
<p>This section subsets the RMSE values to just those we’re using for the rest of the comparisons:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Only look at one setting per method</span>
<span class="va">error_rmse</span> <span class="op">&lt;-</span> <span class="va">error_rmse_wsetting</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">setting</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rigid"</span>, <span class="st">"Quadratic"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">setting</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarization-of-motion-detection-errors">2. Summarization of Motion Detection Errors<a class="anchor" aria-label="anchor" href="#summarization-of-motion-detection-errors"></a>
</h3>
<p>Here we summarize how big errors were in estimating head motion. We first look at the distribution of errors to check that it’s centered around zero. This is the case for both eddy and shoreline.</p>
<p>Next we see what the standard deviation of the error is. This tells us, on average, the amount of degrees or mm we can expect an error to be for each method.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            sd_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            se_rmse<span class="op">=</span><span class="va">sd_rmse</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span><span class="op">)</span>,
            group_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'motion.type',</span>
<span class="co">## 'method'. You can override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries</span> <span class="op">&lt;-</span> <span class="va">rmse_summaries</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>motion.type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span>
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Rotation"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Rotation (degrees)"</span>,
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">motion.type</span>, <span class="st">"Translation"</span><span class="op">)</span>  <span class="op">~</span> <span class="st">"Translation (mm)"</span>,
  <span class="op">)</span><span class="op">)</span>

<span class="va">pd</span><span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.7</span>, preserve<span class="op">=</span><span class="st">"single"</span><span class="op">)</span>

<span class="va">error_mean_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, y<span class="op">=</span><span class="va">group_mean_error</span>, 
        fill<span class="op">=</span><span class="va">method</span><span class="co">#, pattern_alpha=denoising</span>
        <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#scale_pattern_type_discrete(choices=c("hatch")) +</span>
  <span class="co"># geom_col_pattern(position=pd,</span>
  <span class="co">#                  width=0.5,</span>
  <span class="co">#                  pattern_spacing=0.03,</span>
  <span class="co">#                  pattern_fill="black",</span>
  <span class="co">#                  color="black") +</span>
    <span class="fu">geom_col</span><span class="op">(</span><span class="co">#position=pd,</span>
                   <span class="co">#width=0.5,</span>
                   <span class="co">#pattern_spacing=0.03,</span>
                   <span class="co">#pattern_fill="black",</span>
                   <span class="co">#color="black"</span>
             <span class="op">)</span> <span class="op">+</span>
  <span class="co"># scale_pattern_alpha_discrete(</span>
  <span class="co">#   range=c(0,.7),</span>
  <span class="co">#   labels=c("MP-PCA", "None")) +</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">group_mean_error</span><span class="op">+</span><span class="va">mean_rmse</span>, 
        ymin<span class="op">=</span><span class="va">group_mean_error</span><span class="op">-</span><span class="va">mean_rmse</span>, 
        width<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, 
    position<span class="op">=</span><span class="va">pd</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Head Motion Estimate Error"</span>, 
       y <span class="op">=</span> <span class="st">"Mean Error (±Mean RMSE)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span><span class="co">#,</span>
       <span class="co">#pattern_alpha="Denoising\nMethod"</span>
       <span class="op">)</span> <span class="co">#+</span>
  <span class="co">#coord_fixed()</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#error_mean_plt</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Summarize the motion rmse in the different cells</span>
<span class="va">rmse_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, 
        y<span class="op">=</span><span class="va">mean_rmse</span>, 
        fill<span class="op">=</span><span class="va">method</span>, 
        pattern_alpha<span class="op">=</span><span class="va">denoising</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_pattern_type_discrete</span><span class="op">(</span>
    choices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hatch"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col_pattern</span><span class="op">(</span>position<span class="op">=</span><span class="va">pd</span>,
                   width<span class="op">=</span><span class="fl">0.5</span>,
                   pattern_spacing<span class="op">=</span><span class="fl">0.03</span>,
                   pattern_fill<span class="op">=</span><span class="st">"black"</span>,
                   color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_pattern_alpha_discrete</span><span class="op">(</span>
    range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MP-PCA"</span>, <span class="st">"None"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">mean_rmse</span><span class="op">+</span><span class="va">sd_rmse</span>, ymin<span class="op">=</span><span class="va">mean_rmse</span><span class="op">-</span><span class="va">sd_rmse</span>, width<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, 
    position<span class="op">=</span><span class="va">pd</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Motion Estimate RMSE"</span>,
       y <span class="op">=</span> <span class="st">"Mean RMSE (±SD)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span>,
       pattern_alpha<span class="op">=</span><span class="st">"Denoising\nMethod"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: scale_pattern_alpha_discrete(): Using alpha for a discrete variable is</span>
<span class="co">## not advised.</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#rmse_plt</span></code></pre></div>
<p>Here is how means were reported in the paper, and also how they were calculated for the OHBM poster.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">errs</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span>
<span class="fu">tbl_summary</span><span class="op">(</span><span class="va">error_rmse</span>, by <span class="op">=</span> <span class="va">motion.type</span>, statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">all_continuous</span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{mean} ({sd})"</span><span class="op">)</span>, include <span class="op">=</span> <span class="op">)</span></code></pre></div>
<div id="pjrzlrvbgu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pjrzlrvbgu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pjrzlrvbgu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjrzlrvbgu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pjrzlrvbgu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pjrzlrvbgu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjrzlrvbgu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjrzlrvbgu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pjrzlrvbgu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pjrzlrvbgu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pjrzlrvbgu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pjrzlrvbgu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pjrzlrvbgu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pjrzlrvbgu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pjrzlrvbgu .gt_from_md > :first-child {
  margin-top: 0;
}

#pjrzlrvbgu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pjrzlrvbgu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pjrzlrvbgu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pjrzlrvbgu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pjrzlrvbgu .gt_row_group_first td {
  border-top-width: 2px;
}

#pjrzlrvbgu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjrzlrvbgu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pjrzlrvbgu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pjrzlrvbgu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjrzlrvbgu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjrzlrvbgu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pjrzlrvbgu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pjrzlrvbgu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjrzlrvbgu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjrzlrvbgu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjrzlrvbgu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjrzlrvbgu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjrzlrvbgu .gt_left {
  text-align: left;
}

#pjrzlrvbgu .gt_center {
  text-align: center;
}

#pjrzlrvbgu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pjrzlrvbgu .gt_font_normal {
  font-weight: normal;
}

#pjrzlrvbgu .gt_font_bold {
  font-weight: bold;
}

#pjrzlrvbgu .gt_font_italic {
  font-style: italic;
}

#pjrzlrvbgu .gt_super {
  font-size: 65%;
}

#pjrzlrvbgu .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#pjrzlrvbgu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#pjrzlrvbgu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pjrzlrvbgu .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#pjrzlrvbgu .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#pjrzlrvbgu .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>Rotation</strong>, N = 1,080<sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>Translation</strong>, N = 1,080<sup class="gt_footnote_marks">1</sup>
</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left">denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">dwidenoise</td>
<td class="gt_row gt_center">540 (50%)</td>
<td class="gt_row gt_center">540 (50%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">none</td>
<td class="gt_row gt_center">540 (50%)</td>
<td class="gt_row gt_center">540 (50%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">patch2self</td>
<td class="gt_row gt_center">0 (0%)</td>
<td class="gt_row gt_center">0 (0%)</td>
</tr>
<tr>
<td class="gt_row gt_left">scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">ABCD</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">HCP</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">DSIQ5</td>
<td class="gt_row gt_center">180 (17%)</td>
<td class="gt_row gt_center">180 (17%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">HASC55</td>
<td class="gt_row gt_center">180 (17%)</td>
<td class="gt_row gt_center">180 (17%)</td>
</tr>
<tr>
<td class="gt_row gt_left">method</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">Eddy</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">SHORELine</td>
<td class="gt_row gt_center">720 (67%)</td>
<td class="gt_row gt_center">720 (67%)</td>
</tr>
<tr>
<td class="gt_row gt_left">percent_motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">15</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">30</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px;">50</td>
<td class="gt_row gt_center">360 (33%)</td>
<td class="gt_row gt_center">360 (33%)</td>
</tr>
<tr>
<td class="gt_row gt_left">iternum</td>
<td class="gt_row gt_center">16 (9)</td>
<td class="gt_row gt_center">16 (9)</td>
</tr>
<tr>
<td class="gt_row gt_left">rmse</td>
<td class="gt_row gt_center">1.20 (0.67)</td>
<td class="gt_row gt_center">0.76 (0.30)</td>
</tr>
<tr>
<td class="gt_row gt_left">mean_error</td>
<td class="gt_row gt_center">0.19 (0.39)</td>
<td class="gt_row gt_center">0.01 (0.20)</td>
</tr>
<tr>
<td class="gt_row gt_left">sd_error</td>
<td class="gt_row gt_center">1.14 (0.64)</td>
<td class="gt_row gt_center">0.74 (0.29)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="3">
<sup class="gt_footnote_marks">1</sup> n (%); Mean (SD)</td>
    </tr></tfoot>
</table>
</div>
</div>
<div class="section level3">
<h3 id="compare-performance-on-sampling-schemes">3. Compare Performance on Sampling Schemes<a class="anchor" aria-label="anchor" href="#compare-performance-on-sampling-schemes"></a>
</h3>
<p>There are 4 sampling schemes compared here. How well do the motion correction methods work on each?</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries_collapsed</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">motion.type</span>, <span class="va">method</span>, <span class="va">denoising</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            sd_rmse<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span>, 
            se_rmse<span class="op">=</span><span class="va">sd_rmse</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rmse</span><span class="op">)</span><span class="op">)</span>,
            group_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span>,
            sd_mean_error<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_error</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>denoised <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">denoising</span>, none<span class="op">=</span><span class="st">""</span>, dwidenoise<span class="op">=</span><span class="st">"+ MP-PCA"</span><span class="op">)</span>,
         method_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">denoised</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">denoised</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">method_name</span> <span class="op">!=</span> <span class="st">"SHORELine + MP-PCA"</span><span class="op">)</span> <span class="co"># no difference, so skip it</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'scheme', 'motion.type', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">num_directions</span> <span class="op">&lt;-</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="fl">103</span>,
  HCP<span class="op">=</span><span class="fl">270</span>,
  DSIQ5<span class="op">=</span><span class="fl">257</span>,
  HASC55<span class="op">=</span><span class="fl">55</span><span class="op">)</span>

<span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">denoiser</span> <span class="op">&lt;-</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">denoising</span>,
  none<span class="op">=</span><span class="st">"None"</span>,
  dwidenoise<span class="op">=</span><span class="st">"MP-PCA"</span>
<span class="op">)</span>

<span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">scheme_type</span> <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="st">"Shelled"</span>,
  HCP<span class="op">=</span><span class="st">"Shelled"</span>,
  DSIQ5<span class="op">=</span><span class="st">"Non-Shelled"</span>,
  HASC55<span class="op">=</span><span class="st">"Non-Shelled"</span><span class="op">)</span>

<span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">motion.type</span> <span class="op">&lt;-</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">rmse_summaries_collapsed</span><span class="op">$</span><span class="va">motion.type</span>,
  Rotation<span class="op">=</span><span class="st">"Rotation (degrees)"</span>,
  Translation<span class="op">=</span><span class="st">"Translation (mm)"</span>
  <span class="op">)</span>

<span class="co"># Summarize the motion rmse in the different cells</span>
<span class="va">pd2</span> <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>
<span class="va">directions_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">rmse_summaries_collapsed</span>,
    <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">num_directions</span>, y<span class="op">=</span><span class="va">mean_rmse</span>,
        color<span class="op">=</span><span class="va">method</span>,
        shape<span class="op">=</span><span class="va">scheme_type</span>,
        linetype<span class="op">=</span><span class="va">denoiser</span>,
        group<span class="op">=</span><span class="va">method_name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">mean_rmse</span><span class="op">+</span><span class="va">sd_rmse</span>, ymin<span class="op">=</span><span class="va">mean_rmse</span><span class="op">-</span><span class="va">sd_rmse</span><span class="op">)</span>, 
    position<span class="op">=</span><span class="va">pd2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="va">pd2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">.</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span>, <span class="st">"Eddy"</span><span class="op">)</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"None"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"MP-PCA"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMSE by Scheme Type"</span>, 
       y <span class="op">=</span> <span class="st">"Mean RMSE (±SD)"</span>, 
       x <span class="op">=</span> <span class="st">"Number of Directions"</span>, 
       color <span class="op">=</span> <span class="st">"Method"</span>,
       linetype<span class="op">=</span> <span class="st">"Denoising\nMethod"</span>,
       shape<span class="op">=</span><span class="st">"Scheme\nType"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#directions_plt</span></code></pre></div>
<p>This is just another view of the previous plot, but interesting in that it clearly shows that SHORELine’s performance on the 55-direction CS-DSI scan is in the range of the performance on the ABCD multi shell scheme, which has almost twice as many directions. Better statistically test this to be sure:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">error_rmse_dirs</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span>

<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">num_directions</span> <span class="op">&lt;-</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="fl">103</span>,
  HCP<span class="op">=</span><span class="fl">270</span>,
  DSIQ5<span class="op">=</span><span class="fl">257</span>,
  HASC55<span class="op">=</span><span class="fl">55</span><span class="op">)</span>

<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme_type</span> <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">scheme</span>,
  ABCD<span class="op">=</span><span class="st">"Shelled"</span>,
  HCP<span class="op">=</span><span class="st">"Shelled"</span>,
  DSIQ5<span class="op">=</span><span class="st">"Non-Shelled"</span>,
  HASC55<span class="op">=</span><span class="st">"Non-Shelled"</span><span class="op">)</span>

<span class="co"># Convert to percentage values</span>
<span class="va">error_rmse_dirs</span><span class="op">$</span><span class="va">percent_motion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span>
  <span class="va">error_rmse_dirs</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">percent_motion</span><span class="op">]</span><span class="op">)</span>

<span class="va">rotation_shell_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">rmse</span> <span class="op">~</span> <span class="va">scheme_type</span> <span class="op">*</span> <span class="va">num_directions</span> <span class="op">+</span> <span class="va">denoising</span> <span class="op">+</span> <span class="va">percent_motion</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">error_rmse_dirs</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span>

<span class="va">translation_shell_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">rmse</span> <span class="op">~</span> <span class="va">scheme_type</span> <span class="op">*</span> <span class="va">num_directions</span> <span class="op">+</span> <span class="va">denoising</span> <span class="op">+</span> <span class="va">percent_motion</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">error_rmse_dirs</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Translation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">translation_rmse_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">translation_shell_model</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span>

<span class="va">rotation_rmse_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">rotation_shell_model</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tbl_merge</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">translation_rmse_tab</span>, <span class="va">rotation_rmse_tab</span><span class="op">)</span>, tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Translation"</span>, <span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>n_sigfig <span class="op">=</span> <span class="fl">2</span>, <span class="fu">matches</span><span class="op">(</span><span class="st">"Beta"</span><span class="op">)</span>, force_sign <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMSE of Predicted Motion"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Denoising, Number of Volumes, and Percent Motion, including interactions with Shell Scheme"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_source_note</span><span class="op">(</span><span class="fu">md</span><span class="op">(</span><span class="st">"*This data is simulated*"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="qtjqqlnefb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qtjqqlnefb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qtjqqlnefb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtjqqlnefb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qtjqqlnefb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qtjqqlnefb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtjqqlnefb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtjqqlnefb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qtjqqlnefb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qtjqqlnefb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qtjqqlnefb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qtjqqlnefb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qtjqqlnefb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qtjqqlnefb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qtjqqlnefb .gt_from_md > :first-child {
  margin-top: 0;
}

#qtjqqlnefb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qtjqqlnefb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qtjqqlnefb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qtjqqlnefb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qtjqqlnefb .gt_row_group_first td {
  border-top-width: 2px;
}

#qtjqqlnefb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtjqqlnefb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qtjqqlnefb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qtjqqlnefb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtjqqlnefb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtjqqlnefb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qtjqqlnefb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qtjqqlnefb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtjqqlnefb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtjqqlnefb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtjqqlnefb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtjqqlnefb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtjqqlnefb .gt_left {
  text-align: left;
}

#qtjqqlnefb .gt_center {
  text-align: center;
}

#qtjqqlnefb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qtjqqlnefb .gt_font_normal {
  font-weight: normal;
}

#qtjqqlnefb .gt_font_bold {
  font-weight: bold;
}

#qtjqqlnefb .gt_font_italic {
  font-style: italic;
}

#qtjqqlnefb .gt_super {
  font-size: 65%;
}

#qtjqqlnefb .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#qtjqqlnefb .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qtjqqlnefb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qtjqqlnefb .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#qtjqqlnefb .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#qtjqqlnefb .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="7" class="gt_heading gt_title gt_font_normal" style>RMSE of Predicted Motion</th>
    </tr>
<tr>
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Denoising, Number of Volumes, and Percent Motion, including interactions with Shell Scheme</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Translation</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Rotation</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">0.528</td>
<td class="gt_row gt_center">0.487, 0.569</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">1.125</td>
<td class="gt_row gt_center">1.019, 1.231</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme_type</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Shelled</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Non-Shelled</td>
<td class="gt_row gt_center">0.115</td>
<td class="gt_row gt_center">0.068, 0.161</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.278</td>
<td class="gt_row gt_center">-0.398, -0.157</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">num_directions</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, -0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.004</td>
<td class="gt_row gt_center">-0.005, -0.004</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">dwidenoise</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">none</td>
<td class="gt_row gt_center">0.060</td>
<td class="gt_row gt_center">0.039, 0.081</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.335</td>
<td class="gt_row gt_center">0.280, 0.391</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">percent_motion</td>
<td class="gt_row gt_center">0.013</td>
<td class="gt_row gt_center">0.012, 0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.021</td>
<td class="gt_row gt_center">0.019, 0.023</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme_type * num_directions</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">Non-Shelled * num_directions</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, 0.000</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.001</td>
<td class="gt_row gt_center">0.001, 0.002</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="7"><em>This data is simulated</em></td>
    </tr></tfoot>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="7">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<p>A couple interesting results come out here along with some obvious ones. First, there is a main effect of the number of directions. The more directions, the smaller the RMSE.</p>
</div>
<div class="section level3">
<h3 id="head-to-head-comparison-of-shoreline-vs-eddy">4 Head to head comparison of SHORELine vs Eddy<a class="anchor" aria-label="anchor" href="#head-to-head-comparison-of-shoreline-vs-eddy"></a>
</h3>
<p>The ABCD and HCP sequences are the only two schemes we tested that can be processed by both Eddy and SHORELine.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Match the Eddy and SHORELine errors </span>
<span class="va">paired_error</span> <span class="op">&lt;-</span> <span class="va">error_rmse</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">mean_error</span>, <span class="op">-</span><span class="va">sd_error</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">scheme</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABCD"</span>, <span class="st">"HCP"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">rmse</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">group_by</span><span class="op">(</span><span class="va">scheme</span>, <span class="va">motion.type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">mutate</span><span class="op">(</span>shore_difference<span class="op">=</span><span class="va">method_Eddy</span> <span class="op">-</span> <span class="va">method_SHORELine</span>,
         percent_motion<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">percent_motion</span><span class="op">]</span><span class="op">)</span>

<span class="va">rotation_rmse_model_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">shore_difference</span> <span class="op">~</span> <span class="va">scheme</span> <span class="op">*</span> <span class="va">denoising</span> <span class="op">*</span> <span class="va">percent_motion</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">paired_error</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span>

<span class="va">translation_rmse_model_paired</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">shore_difference</span> <span class="op">~</span> <span class="va">scheme</span> <span class="op">*</span> <span class="va">denoising</span> <span class="op">*</span> <span class="va">percent_motion</span>,
  data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">paired_error</span>, <span class="va">motion.type</span><span class="op">==</span><span class="st">"Translation"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">translation_rmse_paired_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">translation_rmse_model_paired</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span>

<span class="va">rotation_rmse_paired_tab</span> <span class="op">&lt;-</span> <span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">rotation_rmse_model_paired</span>, 
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tbl_merge</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">translation_rmse_paired_tab</span>, <span class="va">rotation_rmse_paired_tab</span><span class="op">)</span>, tab_spanner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Translation"</span>, <span class="st">"Rotation"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">fmt_number</span><span class="op">(</span>n_sigfig <span class="op">=</span> <span class="fl">2</span>, <span class="fu">matches</span><span class="op">(</span><span class="st">"Beta"</span><span class="op">)</span>, force_sign <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"RMSE of Predicted Motion Using Paired Eddy &amp; SHORELine Estimates"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Denoising &amp; Percent Motion, and interactions with Shell Scheme"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_source_note</span><span class="op">(</span><span class="fu">md</span><span class="op">(</span><span class="st">"*This data is simulated*"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="lxtoxrygte" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#lxtoxrygte .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lxtoxrygte .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lxtoxrygte .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lxtoxrygte .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lxtoxrygte .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lxtoxrygte .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lxtoxrygte .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lxtoxrygte .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lxtoxrygte .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lxtoxrygte .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lxtoxrygte .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lxtoxrygte .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#lxtoxrygte .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lxtoxrygte .gt_from_md > :first-child {
  margin-top: 0;
}

#lxtoxrygte .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lxtoxrygte .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lxtoxrygte .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lxtoxrygte .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lxtoxrygte .gt_row_group_first td {
  border-top-width: 2px;
}

#lxtoxrygte .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lxtoxrygte .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lxtoxrygte .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lxtoxrygte .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lxtoxrygte .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lxtoxrygte .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lxtoxrygte .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lxtoxrygte .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lxtoxrygte .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lxtoxrygte .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lxtoxrygte .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lxtoxrygte .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lxtoxrygte .gt_left {
  text-align: left;
}

#lxtoxrygte .gt_center {
  text-align: center;
}

#lxtoxrygte .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lxtoxrygte .gt_font_normal {
  font-weight: normal;
}

#lxtoxrygte .gt_font_bold {
  font-weight: bold;
}

#lxtoxrygte .gt_font_italic {
  font-style: italic;
}

#lxtoxrygte .gt_super {
  font-size: 65%;
}

#lxtoxrygte .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#lxtoxrygte .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#lxtoxrygte .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lxtoxrygte .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#lxtoxrygte .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#lxtoxrygte .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="7" class="gt_heading gt_title gt_font_normal" style>RMSE of Predicted Motion Using Paired Eddy &amp; SHORELine Estimates</th>
    </tr>
<tr>
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Denoising &amp; Percent Motion, and interactions with Shell Scheme</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Translation</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Rotation</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">0.129</td>
<td class="gt_row gt_center">0.042, 0.216</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.004</td>
<td class="gt_row gt_center">0.297</td>
<td class="gt_row gt_center">0.056, 0.538</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.016</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">0.059</td>
<td class="gt_row gt_center">-0.065, 0.182</td>
<td class="gt_row gt_center">0.3</td>
<td class="gt_row gt_center">0.254</td>
<td class="gt_row gt_center">-0.087, 0.595</td>
<td class="gt_row gt_center">0.14</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">dwidenoise</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">none</td>
<td class="gt_row gt_center">0.302</td>
<td class="gt_row gt_center">0.178, 0.425</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.512</td>
<td class="gt_row gt_center">0.171, 0.853</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.003</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">percent_motion</td>
<td class="gt_row gt_center">-0.007</td>
<td class="gt_row gt_center">-0.009, -0.004</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">-0.037</td>
<td class="gt_row gt_center">-0.044, -0.030</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme * denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * none</td>
<td class="gt_row gt_center">-0.286</td>
<td class="gt_row gt_center">-0.460, -0.112</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.001</td>
<td class="gt_row gt_center">-0.215</td>
<td class="gt_row gt_center">-0.697, 0.267</td>
<td class="gt_row gt_center">0.4</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme * percent_motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * percent_motion</td>
<td class="gt_row gt_center">0.006</td>
<td class="gt_row gt_center">0.003, 0.010</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
<td class="gt_row gt_center">0.011</td>
<td class="gt_row gt_center">0.001, 0.020</td>
<td class="gt_row gt_center" style="font-weight: bold;">0.034</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">denoising * percent_motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">none * percent_motion</td>
<td class="gt_row gt_center">0.002</td>
<td class="gt_row gt_center">-0.001, 0.006</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">0.033</td>
<td class="gt_row gt_center">0.023, 0.043</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme * denoising * percent_motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP * none * percent_motion</td>
<td class="gt_row gt_center">-0.003</td>
<td class="gt_row gt_center">-0.008, 0.002</td>
<td class="gt_row gt_center">0.2</td>
<td class="gt_row gt_center">-0.028</td>
<td class="gt_row gt_center">-0.042, -0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="7"><em>This data is simulated</em></td>
    </tr></tfoot>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="7">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
<p>Plot the RMSE differences</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">paired_error</span><span class="op">$</span><span class="va">percent_motion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">paired_error</span><span class="op">$</span><span class="va">percent_motion</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">paired_error</span>, 
       <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, 
           y<span class="op">=</span><span class="va">shore_difference</span>,
           fill<span class="op">=</span><span class="va">denoising</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">motion.type</span><span class="op">~</span><span class="va">scheme</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MP-PCA"</span>, <span class="st">"None"</span><span class="op">)</span>,
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dwidenoise"</span><span class="op">=</span><span class="st">"#FFC20A"</span>, <span class="st">"none"</span><span class="op">=</span><span class="st">"#0C7BDC"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Difference in Estimation Error (Eddy - SHORELine)"</span>,
    y <span class="op">=</span> <span class="st">"Estimation Error Difference"</span>,
    x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>,
    fill<span class="op">=</span><span class="st">"Denoising\nMethod"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/rmse_diffs_boxplot-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="qc-metric-comparisons-between-shoreline-and-eddy">QC metric comparisons between SHORELine and Eddy<a class="anchor" aria-label="anchor" href="#qc-metric-comparisons-between-shoreline-and-eddy"></a>
</h2>
<p>While accurately estimating head motion parameters is important, head motion is not the only artifact present in the simulated data. Other factors like eddy current distortion can impact the final quality of the results.</p>
<p>We therefore calculated and compared the Neighboring DWI Correlation (NDC) and FWHM of the final outputs between the two methods. The NDC and FWHM of the results are related, so we used the same method as in Cieslak et al. 2021 where FWHM is partialled out from the NDC measurements.</p>
<div class="section level3">
<h3 id="test-the-settings">1. Test the Settings<a class="anchor" aria-label="anchor" href="#test-the-settings"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"qc_df"</span><span class="op">)</span></code></pre></div>
<p>Above we tested the settings to see if Linear/Quadratic or Rigid/Affine made a difference on motion estimation accuracy. Linear/Quadratic showed no difference, but Rigid performed better than Affine.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">rename</span><span class="op">(</span>hmc_method<span class="op">=</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">hmc_method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">do</span><span class="op">(</span>test <span class="op">=</span> <span class="fu">tidy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">ndc.corrected</span> <span class="op">~</span> <span class="va">setting</span>, data<span class="op">=</span><span class="va">.</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">unnest</span><span class="op">(</span><span class="va">test</span><span class="op">)</span>

<span class="co"># Adjust the p-values and order them by the largest absolute effects</span>
<span class="va">setting_tests</span> <span class="op">&lt;-</span> <span class="va">setting_tests</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>p.value.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># significant.effects &lt;- subset(setting_tests, (p.value.adj &lt; 0.01))</span>
<span class="co"># significant.effects[order(-abs(significant.effects$estimate)),]</span></code></pre></div>
<p>Recall here we’re testing NDC, which is better when higher. The t-tests work the same way here as they did above: all the effects are for SHORELine and the estimates are positive. This means that Affine NDC is higher than Rigid NDC. Although these effects are absolutely tiny, they have a different direction than the RMSE tests: Affine produces higher QC metrics than Rigid, while Rigid is more accurate at estimating head motion than Affine.</p>
<p>To be consistent with the above tests, we will use Rigid for the QC comparisons. Rigid is also remarkably faster than Affine, and could be the first step of a more powerful Eddy Current correction later.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">qc_df</span>, <span class="va">setting</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rigid"</span>, <span class="st">"Quadratic"</span><span class="op">)</span><span class="op">)</span>
<span class="va">qc_df</span><span class="op">$</span><span class="va">setting</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-does-the-fwhm-compare">How does the fwhm compare?<a class="anchor" aria-label="anchor" href="#how-does-the-fwhm-compare"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fwhm_smooth_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">qc_df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span>, y<span class="op">=</span><span class="va">fwhm</span>, fill<span class="op">=</span><span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Spatial Smoothness (FWHM)"</span>, 
       y <span class="op">=</span> <span class="st">"FWHM (mm)"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>, 
       fill <span class="op">=</span> <span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">scheme</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">3.5</span>,<span class="fl">4.5</span><span class="op">)</span>

<span class="va">fwhm_smooth_plot</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 4 rows containing missing values (geom_hline).</span></code></pre>
<p><img src="dmri_hmc_benchmark_files/figure-html/fwhm_plot-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"vignettes"</span>,<span class="st">"fwhm_smooth_plot.svg"</span><span class="op">)</span>,
       plot<span class="op">=</span><span class="va">fwhm_smooth_plot</span>,
       height<span class="op">=</span><span class="fl">3</span>,
       width<span class="op">=</span><span class="fl">7.9</span>,
       units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 4 rows containing missing values (geom_hline).</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># What about if we make a paired comparison?</span>
<span class="va">id_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scheme"</span>, <span class="st">"iternum"</span>, <span class="st">"method"</span>, <span class="st">"denoising"</span>, <span class="st">"percent_motion"</span><span class="op">)</span>

<span class="va">paired_fwhm</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu">one_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id_cols</span>, <span class="st">"fwhm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">fwhm</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>fwhm_diff<span class="op">=</span><span class="va">method_SHORELine</span> <span class="op">-</span> <span class="va">method_Eddy</span>,
         percent_motion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"method_"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fwhm_diff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">fwhm_diff</span> <span class="op">~</span> <span class="va">percent_motion</span> <span class="op">+</span> <span class="va">scheme</span> <span class="op">+</span> <span class="va">denoising</span>,
  data<span class="op">=</span><span class="va">paired_fwhm</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">fwhm_diff_model</span>,
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear Model Predicting FWHM (Eddy — Shoreline) of Each Scan"</span>,
             subtitle <span class="op">=</span> <span class="st">"Main Effects of Percent Motion, Scheme, and Denoising"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_source_note</span><span class="op">(</span><span class="fu">md</span><span class="op">(</span><span class="st">"*This data is simulated*"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="rdtvkysayw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rdtvkysayw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rdtvkysayw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdtvkysayw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rdtvkysayw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rdtvkysayw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdtvkysayw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdtvkysayw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rdtvkysayw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rdtvkysayw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rdtvkysayw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rdtvkysayw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rdtvkysayw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rdtvkysayw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rdtvkysayw .gt_from_md > :first-child {
  margin-top: 0;
}

#rdtvkysayw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rdtvkysayw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rdtvkysayw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rdtvkysayw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rdtvkysayw .gt_row_group_first td {
  border-top-width: 2px;
}

#rdtvkysayw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdtvkysayw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rdtvkysayw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rdtvkysayw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdtvkysayw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdtvkysayw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rdtvkysayw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rdtvkysayw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdtvkysayw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdtvkysayw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdtvkysayw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdtvkysayw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdtvkysayw .gt_left {
  text-align: left;
}

#rdtvkysayw .gt_center {
  text-align: center;
}

#rdtvkysayw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rdtvkysayw .gt_font_normal {
  font-weight: normal;
}

#rdtvkysayw .gt_font_bold {
  font-weight: bold;
}

#rdtvkysayw .gt_font_italic {
  font-style: italic;
}

#rdtvkysayw .gt_super {
  font-size: 65%;
}

#rdtvkysayw .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#rdtvkysayw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rdtvkysayw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rdtvkysayw .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#rdtvkysayw .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#rdtvkysayw .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="4" class="gt_heading gt_title gt_font_normal" style>Linear Model Predicting FWHM (Eddy — Shoreline) of Each Scan</th>
    </tr>
<tr>
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Main Effects of Percent Motion, Scheme, and Denoising</th>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">-0.060</td>
<td class="gt_row gt_center">-0.083, -0.036</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">percent_motion</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">15</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">30</td>
<td class="gt_row gt_center">-0.086</td>
<td class="gt_row gt_center">-0.111, -0.060</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">50</td>
<td class="gt_row gt_center">-0.199</td>
<td class="gt_row gt_center">-0.225, -0.174</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">0.018</td>
<td class="gt_row gt_center">-0.002, 0.039</td>
<td class="gt_row gt_center">0.084</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">-0.009</td>
<td class="gt_row gt_center">-0.030, 0.012</td>
<td class="gt_row gt_center">0.4</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><em>This data is simulated</em></td>
    </tr></tfoot>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
</div>
<div class="section level3">
<h3 id="comparing-fwhm-corrected-ndc-between-shoreline-and-eddy">Comparing FWHM-corrected NDC between SHORELine and Eddy<a class="anchor" aria-label="anchor" href="#comparing-fwhm-corrected-ndc-between-shoreline-and-eddy"></a>
</h3>
<p>Does one of the methods have higher NDC scores? Also what is the improvement in NDC relative to the raw data? We know that higher percent motion will cause lower NDC scores in the unprocessed data.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">improved_ndc_summaries</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span>, 
            sd_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span>, 
            se_ndc<span class="op">=</span><span class="va">sd_ndc</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">improved.ndc.corrected</span><span class="op">)</span><span class="op">)</span>,
            group_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span>,
            sd_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">improved_ndc_summaries</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="st">'NDC Change From Raw'</span>
<span class="va">ndc_summaries</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">denoising</span>, <span class="va">scheme</span>, <span class="va">method</span>, <span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">summarise</span><span class="op">(</span>mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span>, 
            sd_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span>, 
            se_ndc<span class="op">=</span><span class="va">sd_ndc</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ndc.corrected</span><span class="op">)</span><span class="op">)</span>,
            group_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span>,
            sd_mean_ndc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">mean_ndc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'denoising', 'scheme', 'method'. You can</span>
<span class="co">## override using the `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_summaries</span><span class="op">$</span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="st">'Mean Preprocessed NDC'</span>
<span class="va">qc_summaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ndc_summaries</span>, <span class="va">improved_ndc_summaries</span><span class="op">)</span>
<span class="va">qc_summaries</span><span class="op">$</span><span class="va">percent_motion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">qc_summaries</span><span class="op">$</span><span class="va">percent_motion</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pd</span><span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.7</span>, preserve<span class="op">=</span><span class="st">"single"</span><span class="op">)</span>

<span class="va">ndc_mean_plt</span> <span class="op">&lt;-</span>  <span class="fu">ggplot</span><span class="op">(</span>
    <span class="va">qc_summaries</span>,
    <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, 
        y<span class="op">=</span><span class="va">group_mean_ndc</span>, 
        fill<span class="op">=</span><span class="va">method</span>, 
        pattern_alpha<span class="op">=</span><span class="va">denoising</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_pattern_type_discrete</span><span class="op">(</span>
    choices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hatch"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col_pattern</span><span class="op">(</span>position<span class="op">=</span><span class="va">pd</span>,
                   width<span class="op">=</span><span class="fl">0.5</span>,
                   pattern_spacing<span class="op">=</span><span class="fl">0.03</span>,
                   pattern_fill<span class="op">=</span><span class="st">"black"</span>,
                   color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_pattern_alpha_discrete</span><span class="op">(</span>
    range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.7</span><span class="op">)</span>,
    labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MP-PCA"</span>, <span class="st">"None"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>ymax<span class="op">=</span><span class="va">group_mean_ndc</span><span class="op">+</span><span class="va">sd_ndc</span>, ymin<span class="op">=</span><span class="va">group_mean_ndc</span><span class="op">-</span><span class="va">sd_ndc</span>, width<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, 
    position<span class="op">=</span><span class="va">pd</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_grid</span><span class="op">(</span><span class="va">measure</span><span class="op">~</span><span class="va">scheme</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_manual</span><span class="op">(</span>
    values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SHORELine"</span><span class="op">=</span><span class="st">"#d95f02"</span>, <span class="st">"Eddy"</span><span class="op">=</span><span class="st">"#1b9e77"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span>
    base_family<span class="op">=</span><span class="st">"Helvetica"</span>,
    base_size<span class="op">=</span><span class="fl">12</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"QC Measure"</span>, 
       y <span class="op">=</span> <span class="st">"Neighboring DWI Correlation"</span>, 
       x <span class="op">=</span> <span class="st">"Percent Motion Volumes"</span>,
       fill <span class="op">=</span> <span class="st">"Method"</span>,
       pattern_alpha<span class="op">=</span><span class="st">"Denoising\nMethod"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: scale_pattern_alpha_discrete(): Using alpha for a discrete variable is</span>
<span class="co">## not advised.</span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ndc_mean_plt</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggsave</span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"vignettes"</span>,<span class="st">"ndc_mean_plot.svg"</span><span class="op">)</span>,
       plot<span class="op">=</span><span class="va">ndc_mean_plt</span>,
       height<span class="op">=</span><span class="fl">3</span>,
       width<span class="op">=</span><span class="fl">7.9</span>,
       units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></code></pre></div>
<p>The NDC scores in and of themselves don’t mean much across sampling schemes, but are comparable within sampling schemes. The top row shows that MP-PCA improves NDC scores across the board and also that Eddy has a small advantage in the two shelled schemes where it can be used.</p>
<p>The second row shows the percent improvement in NDC relative to the raw scans. This is pretty remarkable. To do statistical tests, we will center the raw NDC <em>within</em> their percent motion category</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">qc_df</span>, <span class="va">scheme</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABCD"</span>, <span class="st">"HCP"</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">qc_df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, y<span class="op">=</span><span class="va">raw_neighbor_corr</span>, color<span class="op">=</span><span class="va">scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Unprocessed data NDC values"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qc_df</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
   <span class="fu">group_by</span><span class="op">(</span><span class="va">percent_motion</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
   <span class="fu">mutate</span><span class="op">(</span>pct_motion_mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">raw_neighbor_corr</span><span class="op">)</span>,
          centered_raw_ndc<span class="op">=</span><span class="va">raw_neighbor_corr</span> <span class="op">-</span> <span class="va">pct_motion_mean</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">qc_df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">percent_motion</span>, y<span class="op">=</span><span class="va">centered_raw_ndc</span>, color<span class="op">=</span><span class="va">scheme</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Unprocessed data NDC values: Centered by percent motion"</span><span class="op">)</span></code></pre></div>
<p><img src="dmri_hmc_benchmark_files/figure-html/center_raw_ndc-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">paired_ndc</span> <span class="op">&lt;-</span> <span class="va">qc_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">select</span><span class="op">(</span><span class="fu">one_of</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">id_cols</span>, <span class="st">"ndc.corrected"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">spread</span><span class="op">(</span><span class="va">method</span>, <span class="va">ndc.corrected</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">mutate</span><span class="op">(</span>ndc_diff<span class="op">=</span><span class="va">method_SHORELine</span> <span class="op">-</span> <span class="va">method_Eddy</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"method_"</span><span class="op">)</span><span class="op">)</span>

<span class="va">ndc_diff_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span>
  <span class="va">ndc_diff</span> <span class="op">~</span> <span class="va">percent_motion</span> <span class="op">+</span> <span class="va">denoising</span> <span class="op">+</span> <span class="va">scheme</span>,
  data<span class="op">=</span><span class="va">paired_ndc</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tbl_regression</span><span class="op">(</span>
  <span class="va">ndc_diff_model</span>,
  intercept<span class="op">=</span><span class="cn">TRUE</span>,
  estimate_fun <span class="op">=</span> <span class="op">~</span><span class="fu">style_number</span><span class="op">(</span><span class="va">.x</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_p</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">bold_labels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">italicize_levels</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">as_gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_header</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"NDC Model"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">tab_source_note</span><span class="op">(</span><span class="fu">md</span><span class="op">(</span><span class="st">"*This data is simulated*"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="gpqcxuscyj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gpqcxuscyj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gpqcxuscyj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gpqcxuscyj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gpqcxuscyj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gpqcxuscyj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gpqcxuscyj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gpqcxuscyj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gpqcxuscyj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gpqcxuscyj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gpqcxuscyj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gpqcxuscyj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gpqcxuscyj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gpqcxuscyj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gpqcxuscyj .gt_from_md > :first-child {
  margin-top: 0;
}

#gpqcxuscyj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gpqcxuscyj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gpqcxuscyj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gpqcxuscyj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gpqcxuscyj .gt_row_group_first td {
  border-top-width: 2px;
}

#gpqcxuscyj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gpqcxuscyj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gpqcxuscyj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gpqcxuscyj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gpqcxuscyj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gpqcxuscyj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gpqcxuscyj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gpqcxuscyj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gpqcxuscyj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gpqcxuscyj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gpqcxuscyj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gpqcxuscyj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gpqcxuscyj .gt_left {
  text-align: left;
}

#gpqcxuscyj .gt_center {
  text-align: center;
}

#gpqcxuscyj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gpqcxuscyj .gt_font_normal {
  font-weight: normal;
}

#gpqcxuscyj .gt_font_bold {
  font-weight: bold;
}

#gpqcxuscyj .gt_font_italic {
  font-style: italic;
}

#gpqcxuscyj .gt_super {
  font-size: 65%;
}

#gpqcxuscyj .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#gpqcxuscyj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#gpqcxuscyj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gpqcxuscyj .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#gpqcxuscyj .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#gpqcxuscyj .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_header"><tr>
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>NDC Model</th>
    </tr></thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">
<strong>95% CI</strong><sup class="gt_footnote_marks">1</sup>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"><strong>p-value</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">(Intercept)</td>
<td class="gt_row gt_center">-0.020</td>
<td class="gt_row gt_center">-0.026, -0.014</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">percent_motion</td>
<td class="gt_row gt_center">-0.001</td>
<td class="gt_row gt_center">-0.001, -0.001</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">denoising</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">MP-PCA</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">None</td>
<td class="gt_row gt_center">0.016</td>
<td class="gt_row gt_center">0.011, 0.020</td>
<td class="gt_row gt_center" style="font-weight: bold;">&lt;0.001</td>
</tr>
<tr>
<td class="gt_row gt_left" style="font-weight: bold;">scheme</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">ABCD</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center">—</td>
<td class="gt_row gt_center"></td>
</tr>
<tr>
<td class="gt_row gt_left" style="text-align: left; text-indent: 10px; font-style: italic;">HCP</td>
<td class="gt_row gt_center">-0.004</td>
<td class="gt_row gt_center">-0.008, 0.000</td>
<td class="gt_row gt_center">0.072</td>
</tr>
</tbody>
<tfoot class="gt_sourcenotes"><tr>
<td class="gt_sourcenote" colspan="4"><em>This data is simulated</em></td>
    </tr></tfoot>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="4">
<sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr></tfoot>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
